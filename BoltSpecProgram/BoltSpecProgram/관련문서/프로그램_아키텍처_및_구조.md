# Excel ë™ì  ê³„ì¸µí˜• ì½¤ë³´ë°•ìŠ¤ UI í”„ë¡œê·¸ë¨ - ì•„í‚¤í…ì²˜ ë° êµ¬ì¡°

## ğŸ“‹ ëª©ì°¨

1. [ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”](#1-ì „ì²´-ì•„í‚¤í…ì²˜-ê°œìš”)
2. [ë ˆì´ì–´ ì•„í‚¤í…ì²˜](#2-ë ˆì´ì–´-ì•„í‚¤í…ì²˜)
3. [ì£¼ìš” í´ë˜ìŠ¤ ë° ì±…ì„](#3-ì£¼ìš”-í´ë˜ìŠ¤-ë°-ì±…ì„)
4. [ë°ì´í„° íë¦„](#4-ë°ì´í„°-íë¦„)
5. [ê³„ì¸µ í•„í„°ë§ ë©”ì»¤ë‹ˆì¦˜](#5-ê³„ì¸µ-í•„í„°ë§-ë©”ì»¤ë‹ˆì¦˜)
6. [UI ë ˆì´ì•„ì›ƒ êµ¬ì¡°](#6-ui-ë ˆì´ì•„ì›ƒ-êµ¬ì¡°)
7. [ì´ë²¤íŠ¸ ì²˜ë¦¬ íë¦„](#7-ì´ë²¤íŠ¸-ì²˜ë¦¬-íë¦„)
8. [ì €ì¥/ë¡œë“œ ë©”ì»¤ë‹ˆì¦˜](#8-ì €ì¥ë¡œë“œ-ë©”ì»¤ë‹ˆì¦˜)
9. [í™•ì¥ ê°€ëŠ¥ì„±](#9-í™•ì¥-ê°€ëŠ¥ì„±)

---

## 1. ì „ì²´ ì•„í‚¤í…ì²˜ ê°œìš”

### 1.1 ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Presentation Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              MainWindow.xaml / xaml.cs                    â”‚  â”‚
â”‚  â”‚  - UI ì´ë²¤íŠ¸ ì²˜ë¦¬                                          â”‚  â”‚
â”‚  â”‚  - ìœˆë„ìš° ìƒëª…ì£¼ê¸° ê´€ë¦¬                                    â”‚  â”‚
â”‚  â”‚  - ì‚¬ìš©ì ìƒí˜¸ì‘ìš© ì²˜ë¦¬                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          UI Manager Layer                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              DynamicUIManager.cs                          â”‚  â”‚
â”‚  â”‚  - ë™ì  UI ìƒì„± ë° ê´€ë¦¬                                    â”‚  â”‚
â”‚  â”‚  - ê³„ì¸µ í•„í„°ë§ ë¡œì§                                        â”‚  â”‚
â”‚  â”‚  - ì»¨íŠ¸ë¡¤ ìƒíƒœ ê´€ë¦¬                                        â”‚  â”‚
â”‚  â”‚  - ìŠ¤ì¼€ì¼ë§ ë° ë ˆì´ì•„ì›ƒ                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Business Logic Layer                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ HierarchyTreeBuilderâ”‚         â”‚     ExcelReader         â”‚   â”‚
â”‚  â”‚  - ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¶•   â”‚         â”‚  - Excel íŒŒì¼ ì½ê¸°      â”‚   â”‚
â”‚  â”‚  - í•„í„°ë§ ì•Œê³ ë¦¬ì¦˜  â”‚         â”‚  - ë°ì´í„° íŒŒì‹±          â”‚   â”‚
â”‚  â”‚  - ê°’ ê²€ìƒ‰          â”‚         â”‚  - ìƒì† ì²˜ë¦¬            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Data Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  BoltSpecData.cs                          â”‚  â”‚
â”‚  â”‚  - BoltSpecData: ì „ì²´ ë°ì´í„° êµ¬ì¡°                          â”‚  â”‚
â”‚  â”‚  - BoltDataRow: í–‰ ë°ì´í„°                                  â”‚  â”‚
â”‚  â”‚  - HierarchyNode: ê³„ì¸µ íŠ¸ë¦¬ ë…¸ë“œ                           â”‚  â”‚
â”‚  â”‚  - ControlInfo: UI ì»¨íŠ¸ë¡¤ ì •ë³´                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        External Data Source                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  SampleData.xlsx                          â”‚  â”‚
â”‚  â”‚  - ë³¼íŠ¸ ì‚¬ì–‘ ë°ì´í„°                                        â”‚  â”‚
â”‚  â”‚  - ê³„ì¸µ êµ¬ì¡° ì •ì˜                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ì„¤ê³„ ì›ì¹™

**1. ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ (Separation of Concerns)**
- **Presentation**: UI í‘œì‹œ ë° ì‚¬ìš©ì ìƒí˜¸ì‘ìš©
- **UI Manager**: ë™ì  UI ìƒì„± ë° ê´€ë¦¬
- **Business Logic**: ë°ì´í„° ì²˜ë¦¬ ë° ê³„ì¸µ í•„í„°ë§
- **Data**: ë°ì´í„° ëª¨ë¸ ë° êµ¬ì¡°

**2. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (Single Responsibility)**
- ê° í´ë˜ìŠ¤ëŠ” ëª…í™•í•œ ë‹¨ì¼ ì±…ì„ì„ ê°€ì§
- ExcelReader: Excel ì½ê¸°ë§Œ ë‹´ë‹¹
- HierarchyTreeBuilder: ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¶• ë° í•„í„°ë§ë§Œ ë‹´ë‹¹
- DynamicUIManager: UI ìƒì„± ë° ê´€ë¦¬ë§Œ ë‹´ë‹¹

**3. ì˜ì¡´ì„± ì—­ì „ (Dependency Inversion)**
- MainWindowëŠ” DynamicUIManagerì— ì˜ì¡´
- DynamicUIManagerëŠ” HierarchyTreeBuilderì™€ Data Modelì— ì˜ì¡´
- ìƒìœ„ ë ˆì´ì–´ê°€ í•˜ìœ„ ë ˆì´ì–´ì— ì˜ì¡´

---

## 2. ë ˆì´ì–´ ì•„í‚¤í…ì²˜

### 2.1 Presentation Layer (í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µ)

**ì±…ì„:**
- ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ í‘œì‹œ
- ì‚¬ìš©ì ì…ë ¥ ì²˜ë¦¬
- ì´ë²¤íŠ¸ í•¸ë“¤ë§
- ìœˆë„ìš° ìƒëª…ì£¼ê¸° ê´€ë¦¬

**êµ¬ì„± ìš”ì†Œ:**
```
MainWindow.xaml
â”œâ”€â”€ Menu Bar (íŒŒì¼, í¸ì§‘)
â”œâ”€â”€ Category Panel (ì¢…ë¥˜ í‘œì‹œ)
â”œâ”€â”€ Canvas Area
â”‚   â”œâ”€â”€ Canvas1 (ìƒë‹¨ ì˜ì—­)
â”‚   â””â”€â”€ Canvas2 (í•˜ë‹¨ ì˜ì—­)
â””â”€â”€ Status Area (í•˜ë‹¨ ë²„íŠ¼ë“¤)

MainWindow.xaml.cs
â”œâ”€â”€ Window_Loaded()
â”œâ”€â”€ OpenExcel_Click()
â”œâ”€â”€ Window_SizeChanged()
â”œâ”€â”€ OnKeyDown() (Ctrl+M, Ctrl+S)
â””â”€â”€ ê¸°íƒ€ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
```

### 2.2 UI Manager Layer (UI ê´€ë¦¬ ê³„ì¸µ)

**ì±…ì„:**
- ë™ì  UI ì»¨íŠ¸ë¡¤ ìƒì„±
- ê³„ì¸µ í•„í„°ë§ ë¡œì§ ì‹¤í–‰
- ì»¨íŠ¸ë¡¤ ìƒíƒœ ê´€ë¦¬
- ë ˆì´ì•„ì›ƒ ë° ìŠ¤ì¼€ì¼ë§
- ì»¨íŠ¸ë¡¤ ì´ë™ ëª¨ë“œ ê´€ë¦¬

**ì£¼ìš” ë©”ì„œë“œ:**
```csharp
DynamicUIManager
â”œâ”€â”€ BuildUI()                    // UI ì „ì²´ êµ¬ì¶•
â”œâ”€â”€ DisplayCategory()            // ì¢…ë¥˜ í‘œì‹œ
â”œâ”€â”€ CreateDynamicControl()       // ê³„ì¸µ ì»¨íŠ¸ë¡¤ ìƒì„±
â”œâ”€â”€ CreateLeafControl()          // ë¦¬í”„ ì»¨íŠ¸ë¡¤ ìƒì„±
â”œâ”€â”€ OnHierarchySelectionChanged() // ì„ íƒ ë³€ê²½ ì²˜ë¦¬
â”œâ”€â”€ UpdateDependentControls()    // í•˜ìœ„ ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
â”œâ”€â”€ UpdateLeafControls()         // ë¦¬í”„ ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
â”œâ”€â”€ ScaleControls()              // ì»¨íŠ¸ë¡¤ ìŠ¤ì¼€ì¼ë§
â””â”€â”€ SaveControlPositions()       // ìœ„ì¹˜ ì €ì¥
```

### 2.3 Business Logic Layer (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê³„ì¸µ)

**ì±…ì„:**
- Excel ë°ì´í„° ì½ê¸° ë° íŒŒì‹±
- ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¶•
- í•„í„°ë§ ì•Œê³ ë¦¬ì¦˜
- ë°ì´í„° ê²€ìƒ‰ ë° ì¡°íšŒ

**êµ¬ì„± ìš”ì†Œ:**

**ExcelReader:**
```csharp
- ReadExcel()          // Excel íŒŒì¼ ì½ê¸°
- ë°ì´í„° ìƒì† ì²˜ë¦¬     // ë¹ˆ ì…€ì„ ìƒìœ„ í–‰ì—ì„œ ìƒì†
- CompleteValues êµ¬ì¶•  // ì™„ì „í•œ í–‰ ë°ì´í„° ìƒì„±
```

**HierarchyTreeBuilder:**
```csharp
- BuildTree()                 // ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¶•
- GetAvailableValues()        // í•„í„°ë§ëœ ê°’ ì¡°íšŒ
- GetLeafValues()             // ë¦¬í”„ ê°’ ì¡°íšŒ
- AddRowToTree()              // ì¬ê·€ì  íŠ¸ë¦¬ êµ¬ì¶•
```

### 2.4 Data Layer (ë°ì´í„° ê³„ì¸µ)

**ì±…ì„:**
- ë°ì´í„° êµ¬ì¡° ì •ì˜
- ë°ì´í„° ëª¨ë¸ ì œê³µ
- íƒ€ì… ì•ˆì •ì„± ë³´ì¥

**ë°ì´í„° ëª¨ë¸:**
```csharp
BoltSpecData
â”œâ”€â”€ Headers: List<string>           // ì»¬ëŸ¼ í—¤ë”
â””â”€â”€ DataRows: List<BoltDataRow>     // ë°ì´í„° í–‰ë“¤

BoltDataRow
â”œâ”€â”€ Values: Dictionary<string, string>         // ì›ë³¸ ê°’
â””â”€â”€ CompleteValues: Dictionary<string, string> // ìƒì†ëœ ì™„ì „í•œ ê°’

HierarchyNode
â”œâ”€â”€ ColumnIndex: int
â”œâ”€â”€ ColumnName: string
â”œâ”€â”€ Value: string
â”œâ”€â”€ Children: List<HierarchyNode>              // í•˜ìœ„ ë…¸ë“œ
â””â”€â”€ LeafValues: Dictionary<string, string>     // ë¦¬í”„ ê°’

ControlInfo
â”œâ”€â”€ ColumnName: string
â”œâ”€â”€ ColumnIndex: int
â”œâ”€â”€ Type: ControlType
â”œâ”€â”€ Control: Control                           // ì‹¤ì œ ì»¨íŠ¸ë¡¤
â”œâ”€â”€ Label: Label
â”œâ”€â”€ GroupBorder: Border
â”œâ”€â”€ Position: (Left, Top, Width, Height)
â””â”€â”€ Initial Position: (ì´ˆê¸° ìœ„ì¹˜)
```

---

## 3. ì£¼ìš” í´ë˜ìŠ¤ ë° ì±…ì„

### 3.1 MainWindow

**ì—­í• :** ë©”ì¸ ìœˆë„ìš° ë° ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬

**ì£¼ìš” ì†ì„±:**
```csharp
private BoltSpecData _data;                    // ì „ì²´ ë°ì´í„°
private ExcelReader _excelReader;              // Excel ë¦¬ë”
private DynamicUIManager _uiManager;           // UI ê´€ë¦¬ì
private bool _isControlMoveMode;               // ì»¨íŠ¸ë¡¤ ì´ë™ ëª¨ë“œ
private FrameworkElement _selectedControlForMove; // ì´ë™í•  ì»¨íŠ¸ë¡¤
```

**ì£¼ìš” ë©”ì„œë“œ:**
```csharp
- Window_Loaded()           // í”„ë¡œê·¸ë¨ ì‹œì‘ ì‹œ ê¸°ë³¸ íŒŒì¼ ë¡œë“œ
- OpenExcel_Click()         // Excel íŒŒì¼ ì—´ê¸°
- Window_SizeChanged()      // ìœˆë„ìš° í¬ê¸° ë³€ê²½ ì‹œ ìŠ¤ì¼€ì¼ë§
- OnKeyDown()               // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ (Ctrl+M, Ctrl+S)
- Save_Click()              // JSON ì €ì¥
- Load_Click()              // JSON ë¡œë“œ
```

**ì±…ì„ ë²”ìœ„:**
- âœ… ìœˆë„ìš° ì´ë²¤íŠ¸ ì²˜ë¦¬
- âœ… íŒŒì¼ ì—´ê¸°/ì €ì¥ UI
- âœ… í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì²˜ë¦¬
- âŒ UI ìƒì„± ë¡œì§ (DynamicUIManager ë‹´ë‹¹)
- âŒ ë°ì´í„° ì²˜ë¦¬ ë¡œì§ (ExcelReader ë‹´ë‹¹)

### 3.2 DynamicUIManager

**ì—­í• :** ë™ì  UI ìƒì„± ë° ê´€ë¦¬ì˜ í•µì‹¬ í´ë˜ìŠ¤

**ì£¼ìš” ì†ì„±:**
```csharp
private MainWindow _mainWindow;                      // ë¶€ëª¨ ìœˆë„ìš°
private BoltSpecData _data;                          // ë°ì´í„°
private Dictionary<string, ControlInfo> _controls;   // ì»¨íŠ¸ë¡¤ ë§µ
private Dictionary<int, string> _selectedPath;       // ì„ íƒ ê²½ë¡œ
private HierarchyTreeBuilder _treeBuilder;           // íŠ¸ë¦¬ ë¹Œë”
private List<HierarchyNode> _hierarchyTree;          // ê³„ì¸µ íŠ¸ë¦¬
private Canvas _canvas1, _canvas2;                   // ìº”ë²„ìŠ¤
```

**í•µì‹¬ ë©”ì„œë“œ:**

**1. UI êµ¬ì¶•:**
```csharp
public void BuildUI(BoltSpecData data)
{
    // 1. ì´ˆê¸°í™”
    _data = data;
    _controls.Clear();
    _selectedPath.Clear();
    
    // 2. ì¢…ë¥˜ í‘œì‹œ (Headers[1])
    DisplayCategory(data.Headers[1]);
    
    // 3. ê³„ì¸µ ì»¬ëŸ¼ ì¸ë±ìŠ¤ ê²°ì • (Headers[2]~[8])
    var hierarchyColumns = new List<int> { 2, 3, 4, 5, 6, 7, 8 };
    
    // 4. ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¶•
    _treeBuilder = new HierarchyTreeBuilder(data, hierarchyColumns);
    _hierarchyTree = _treeBuilder.BuildTree();
    
    // 5. UI ì»¨íŠ¸ë¡¤ ë™ì  ìƒì„±
    foreach (var colIndex in hierarchyColumns)
        CreateDynamicControl(colIndex, hierarchyColumns, ...);
    
    // 6. ë¦¬í”„ ì»¨íŠ¸ë¡¤ ìƒì„±
    for (int i = 9; i < data.Headers.Count; i++)
        CreateLeafControl(i, ...);
    
    // 7. Canvas í¬ê¸° ìë™ ì¡°ì •
    AdjustCanvasSize();
}
```

**2. ê³„ì¸µ í•„í„°ë§:**
```csharp
private void OnHierarchySelectionChanged(int columnIndex, string selectedValue)
{
    // 1. ì„ íƒ ê²½ë¡œ ì—…ë°ì´íŠ¸
    if (string.IsNullOrEmpty(selectedValue))
        _selectedPath.Remove(columnIndex);
    else
        _selectedPath[columnIndex] = selectedValue;
    
    // 2. í•˜ìœ„ ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
    UpdateDependentControls(columnIndex);
}

private void UpdateDependentControls(int changedColumnIndex)
{
    // 1. í•˜ìœ„ ì„ íƒ ê²½ë¡œ ì œê±°
    var keysToRemove = _selectedPath.Keys.Where(k => k > changedColumnIndex);
    foreach (var key in keysToRemove)
        _selectedPath.Remove(key);
    
    // 2. ê° í•˜ìœ„ ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
    foreach (var kvp in _controls)
    {
        var controlColumnIndex = _data.Headers.IndexOf(kvp.Key);
        if (controlColumnIndex > changedColumnIndex)
        {
            // í•„í„°ë§ëœ ê°’ ê°€ì ¸ì˜¤ê¸°
            var availableValues = _treeBuilder.GetAvailableValues(
                _hierarchyTree, _selectedPath, controlColumnIndex);
            
            // ComboBox/ListBox ì—…ë°ì´íŠ¸
            UpdateControlItems(kvp.Value.Control, availableValues);
        }
    }
    
    // 3. ë¦¬í”„ ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
    UpdateLeafControls();
}
```

**ì±…ì„ ë²”ìœ„:**
- âœ… ë™ì  UI ìƒì„±
- âœ… ê³„ì¸µ í•„í„°ë§ ì‹¤í–‰
- âœ… ì»¨íŠ¸ë¡¤ ìƒíƒœ ê´€ë¦¬
- âœ… ë ˆì´ì•„ì›ƒ ê´€ë¦¬
- âŒ Excel ì½ê¸° (ExcelReader ë‹´ë‹¹)
- âŒ íŠ¸ë¦¬ êµ¬ì¶• ì•Œê³ ë¦¬ì¦˜ (HierarchyTreeBuilder ë‹´ë‹¹)

### 3.3 ExcelReader

**ì—­í• :** Excel íŒŒì¼ ì½ê¸° ë° ë°ì´í„° íŒŒì‹±

**ì£¼ìš” ë©”ì„œë“œ:**

```csharp
public BoltSpecData ReadExcel(string filePath)
{
    var data = new BoltSpecData();
    using (var package = new ExcelPackage(new FileInfo(filePath)))
    {
        var worksheet = package.Workbook.Worksheets[0];
        
        // 1. í—¤ë” ì½ê¸° (1í–‰)
        for (int col = 1; col <= colCount; col++)
            data.Headers.Add(worksheet.Cells[1, col].Value?.ToString() ?? "");
        
        // 2. ë°ì´í„° ì½ê¸° (2í–‰~)
        var previousRow = new Dictionary<string, string>();
        for (int row = 2; row <= rowCount; row++)
        {
            var dataRow = new BoltDataRow();
            var currentRow = new Dictionary<string, string>();
            
            for (int col = 1; col <= colCount; col++)
            {
                var header = data.Headers[col - 1];
                var value = worksheet.Cells[row, col].Value?.ToString() ?? "";
                
                dataRow.Values[header] = value;
                
                // â­ ë¹ˆ ê°’ì´ë©´ ì´ì „ í–‰ì˜ ê°’ ìƒì†
                if (string.IsNullOrWhiteSpace(value))
                    currentRow[header] = previousRow.ContainsKey(header) 
                        ? previousRow[header] : "";
                else
                    currentRow[header] = value;
            }
            
            dataRow.CompleteValues = new Dictionary<string, string>(currentRow);
            data.DataRows.Add(dataRow);
            previousRow = currentRow;
        }
    }
    return data;
}
```

**ë°ì´í„° ìƒì† ë©”ì»¤ë‹ˆì¦˜:**
```
Excel ë°ì´í„°:
Row 1: ë¶„ë¥˜ | ì¢…ë¥˜         | íƒ€ì… | ê·œê²©
Row 2: ë³¼íŠ¸ë¥˜ | ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸  | KS  | KS B 1002:2016
Row 3:      |             |     | KS W ISO 7913:2023
Row 4:      |             | ISO | ISO 4014

CompleteValues ê²°ê³¼:
Row 2: {ë¶„ë¥˜:ë³¼íŠ¸ë¥˜, ì¢…ë¥˜:ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸, íƒ€ì…:KS, ê·œê²©:KS B 1002:2016}
Row 3: {ë¶„ë¥˜:ë³¼íŠ¸ë¥˜, ì¢…ë¥˜:ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸, íƒ€ì…:KS, ê·œê²©:KS W ISO 7913:2023}
Row 4: {ë¶„ë¥˜:ë³¼íŠ¸ë¥˜, ì¢…ë¥˜:ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸, íƒ€ì…:ISO, ê·œê²©:ISO 4014}
```

### 3.4 HierarchyTreeBuilder

**ì—­í• :** ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¶• ë° í•„í„°ë§ ì•Œê³ ë¦¬ì¦˜ ì œê³µ

**í•µì‹¬ ì•Œê³ ë¦¬ì¦˜:**

**1. íŠ¸ë¦¬ êµ¬ì¶•:**
```csharp
public List<HierarchyNode> BuildTree()
{
    var rootNodes = new List<HierarchyNode>();
    foreach (var row in _data.DataRows)
    {
        AddRowToTree(rootNodes, row, 0);
    }
    return rootNodes;
}

private void AddRowToTree(List<HierarchyNode> currentLevel, 
                          BoltDataRow row, int hierarchyIndex)
{
    if (hierarchyIndex >= _hierarchyColumns.Count)
        return;
    
    int columnIndex = _hierarchyColumns[hierarchyIndex];
    string columnName = _data.Headers[columnIndex];
    string value = row.CompleteValues[columnName];
    
    // ì—¬ëŸ¬ ê°’ ì²˜ë¦¬ (ì‰¼í‘œ/ê°œí–‰ êµ¬ë¶„)
    var values = value.Split(new[] { '\n', ',' }, 
                             StringSplitOptions.RemoveEmptyEntries);
    
    foreach (var val in values)
    {
        // ë…¸ë“œ ì°¾ê¸° ë˜ëŠ” ìƒì„±
        var node = currentLevel.FirstOrDefault(n => n.Value == val);
        if (node == null)
        {
            node = new HierarchyNode
            {
                ColumnIndex = columnIndex,
                ColumnName = columnName,
                Value = val
            };
            currentLevel.Add(node);
        }
        
        // ë§ˆì§€ë§‰ ë ˆë²¨ì´ë©´ ë¦¬í”„ ê°’ ì €ì¥
        if (hierarchyIndex == _hierarchyColumns.Count - 1)
        {
            foreach (var kvp in row.CompleteValues)
            {
                if (!_hierarchyColumns.Contains(_data.Headers.IndexOf(kvp.Key)))
                    node.LeafValues[kvp.Key] = kvp.Value;
            }
        }
        else
        {
            // ì¬ê·€ì ìœ¼ë¡œ í•˜ìœ„ ë ˆë²¨ êµ¬ì¶•
            AddRowToTree(node.Children, row, hierarchyIndex + 1);
        }
    }
}
```

**2. í•„í„°ë§:**
```csharp
public List<string> GetAvailableValues(List<HierarchyNode> tree, 
                                       Dictionary<int, string> selectedPath, 
                                       int targetColumnIndex)
{
    var currentNodes = tree;
    
    // ì„ íƒëœ ê²½ë¡œë¥¼ ë”°ë¼ íŠ¸ë¦¬ íƒìƒ‰
    foreach (var colIndex in _hierarchyColumns)
    {
        // ëª©í‘œ ì»¬ëŸ¼ì— ë„ë‹¬í•˜ë©´ í˜„ì¬ ë ˆë²¨ì˜ ëª¨ë“  ê°’ ë°˜í™˜
        if (colIndex == targetColumnIndex)
        {
            return currentNodes.Select(n => n.Value).Distinct().ToList();
        }
        
        // ì„ íƒëœ ê°’ì´ ìˆìœ¼ë©´ í•´ë‹¹ ë…¸ë“œì˜ ìì‹ìœ¼ë¡œ ì´ë™
        if (selectedPath.ContainsKey(colIndex))
        {
            var selectedValue = selectedPath[colIndex];
            var matchingNode = currentNodes.FirstOrDefault(n => n.Value == selectedValue);
            if (matchingNode != null)
                currentNodes = matchingNode.Children;
            else
                break;
        }
        else
        {
            break;
        }
    }
    
    return new List<string>();
}
```

**íŠ¸ë¦¬ êµ¬ì¡° ì˜ˆì‹œ:**
```
íƒ€ì… (ColumnIndex=2)
â”œâ”€ KS
â”‚  â”œâ”€ ê·œê²© (ColumnIndex=3)
â”‚  â”‚  â”œâ”€ KS B 1002:2016
â”‚  â”‚  â”‚  â”œâ”€ ìš©ë„ (ColumnIndex=4)
â”‚  â”‚  â”‚  â”‚  â”œâ”€ ê¸°ê³„ìš©
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ ì¬ì§ˆ (ColumnIndex=5)
â”‚  â”‚  â”‚  â”‚  â”‚     â”œâ”€ S10C
â”‚  â”‚  â”‚  â”‚  â”‚     â”œâ”€ SS400
â”‚  â”‚  â”‚  â”‚  â”‚     â””â”€ SUS304
â”‚  â”‚  â”‚  â”‚  â”œâ”€ PCìš©
â”‚  â”‚  â”‚  â”‚  â””â”€ íŠ¹ìˆ˜ìš©
â”‚  â”‚  â””â”€ KS W ISO 7913:2023
â”‚  â”‚     â””â”€ í•­ê³µìš°ì£¼ìš©
â”‚  â”‚        â””â”€ SCM435
â”œâ”€ ISO
â”‚  â””â”€ ISO 4014
â”‚     â””â”€ ...
â””â”€ DIN
   â””â”€ DIN 931
      â””â”€ ...
```

---

## 4. ë°ì´í„° íë¦„

### 4.1 ì „ì²´ ë°ì´í„° íë¦„

```
[Excel íŒŒì¼]
    â†“ ExcelReader.ReadExcel()
[BoltSpecData]
    â”œâ”€ Headers: ["ë¶„ë¥˜", "ì¢…ë¥˜", "íƒ€ì…", "ê·œê²©", ...]
    â””â”€ DataRows: [{CompleteValues}, {CompleteValues}, ...]
    â†“ HierarchyTreeBuilder.BuildTree()
[HierarchyNode Tree]
    â””â”€ ê³„ì¸µì  íŠ¸ë¦¬ êµ¬ì¡°
    â†“ DynamicUIManager.BuildUI()
[UI Controls]
    â”œâ”€ íƒ€ì… ComboBox
    â”œâ”€ ê·œê²© ComboBox
    â”œâ”€ ìš©ë„ ComboBox
    â””â”€ ...
    â†“ User Selection
[_selectedPath]
    â””â”€ {2:"KS", 3:"KS B 1002:2016", 4:"ê¸°ê³„ìš©"}
    â†“ HierarchyTreeBuilder.GetAvailableValues()
[Filtered Values]
    â””â”€ ["S10C", "SS400", "SUS304", ...]
    â†“ UpdateDependentControls()
[UI Update]
    â””â”€ í•˜ìœ„ ComboBox ì•„ì´í…œ ì—…ë°ì´íŠ¸
```

### 4.2 ìƒì„¸ íë¦„ë„

**1. ì´ˆê¸° ë¡œë“œ ì‹œí€€ìŠ¤:**
```
ì‚¬ìš©ì
  â”‚
  â”œâ”€ [1] í”„ë¡œê·¸ë¨ ì‹œì‘
  â”‚    â”‚
  â”‚    â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  MainWindow     â”‚
  â”‚  Window_Loaded()â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€ [2] TryLoadDefaultExcelFile()
       â”‚    â”‚
       â”‚    â†“
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  â”‚  ExcelReader     â”‚
       â”‚  â”‚  ReadExcel()     â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚
       â”‚         â†“
       â”‚    BoltSpecData ìƒì„±
       â”‚         â”‚
       â”œâ”€ [3] _uiManager.BuildUI(_data)
       â”‚    â”‚
       â”‚    â†“
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  â”‚ DynamicUIManager    â”‚
       â”‚  â”‚ BuildUI()           â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚         â”‚
       â”‚         â”œâ”€ [3-1] DisplayCategory()
       â”‚         â”‚        â””â”€> "ì¢…ë¥˜: ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸" í‘œì‹œ
       â”‚         â”‚
       â”‚         â”œâ”€ [3-2] HierarchyTreeBuilder ìƒì„±
       â”‚         â”‚        â””â”€> BuildTree()
       â”‚         â”‚              â””â”€> ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¶•
       â”‚         â”‚
       â”‚         â”œâ”€ [3-3] CreateDynamicControl() (ê³„ì¸µ ì»¬ëŸ¼ë“¤)
       â”‚         â”‚        â”œâ”€> íƒ€ì… ComboBox ìƒì„±
       â”‚         â”‚        â”œâ”€> ê·œê²© ComboBox ìƒì„± (ë¹„í™œì„±í™”)
       â”‚         â”‚        â”œâ”€> ìš©ë„ ComboBox ìƒì„± (ë¹„í™œì„±í™”)
       â”‚         â”‚        â””â”€> ...
       â”‚         â”‚
       â”‚         â”œâ”€ [3-4] CreateLeafControl() (ë¦¬í”„ ì»¬ëŸ¼ë“¤)
       â”‚         â”‚        â””â”€> í‘œë©´ì²˜ë¦¬, ë³¼íŠ¸ëë‹¨ ë“±
       â”‚         â”‚
       â”‚         â””â”€ [3-5] AdjustCanvasSize()
       â”‚                  â””â”€> Canvas í¬ê¸° ì¡°ì •
       â”‚
       â””â”€ [4] UI í‘œì‹œ ì™„ë£Œ
```

**2. ì‚¬ìš©ì ì„ íƒ ì‹œí€€ìŠ¤:**
```
ì‚¬ìš©ì
  â”‚
  â”œâ”€ [1] íƒ€ì… ì„ íƒ (ì˜ˆ: "KS")
  â”‚    â”‚
  â”‚    â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  íƒ€ì… ComboBox       â”‚
  â”‚  SelectionChanged    â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€ [2] OnHierarchySelectionChanged(columnIndex=2, value="KS")
       â”‚    â”‚
       â”‚    â”œâ”€ _selectedPath[2] = "KS"
       â”‚    â”‚
       â”‚    â†“
       â”œâ”€ [3] UpdateDependentControls(2)
       â”‚    â”‚
       â”‚    â”œâ”€ [3-1] _selectedPathì—ì„œ í•˜ìœ„ ê²½ë¡œ ì œê±°
       â”‚    â”‚        (3, 4, 5, ... ì œê±°)
       â”‚    â”‚
       â”‚    â”œâ”€ [3-2] foreach (ì»¬ëŸ¼ > 2)
       â”‚    â”‚    â”‚
       â”‚    â”‚    â”œâ”€ GetAvailableValues(tree, {2:"KS"}, 3)
       â”‚    â”‚    â”‚   â””â”€> ["KS B 1002:2016", "KS W ISO 7913:2023"]
       â”‚    â”‚    â”‚
       â”‚    â”‚    â”œâ”€ ê·œê²© ComboBox ì—…ë°ì´íŠ¸
       â”‚    â”‚    â”‚   â”œâ”€ Items.Clear()
       â”‚    â”‚    â”‚   â”œâ”€ Items.Add("KS B 1002:2016")
       â”‚    â”‚    â”‚   â”œâ”€ Items.Add("KS W ISO 7913:2023")
       â”‚    â”‚    â”‚   â””â”€ IsEnabled = true
       â”‚    â”‚    â”‚
       â”‚    â”‚    â”œâ”€ ìš©ë„ ComboBox ì—…ë°ì´íŠ¸
       â”‚    â”‚    â”‚   â”œâ”€ Items.Clear()
       â”‚    â”‚    â”‚   â””â”€ IsEnabled = false (ê·œê²© ì„ íƒ ì „)
       â”‚    â”‚    â”‚
       â”‚    â”‚    â””â”€ ...
       â”‚    â”‚
       â”‚    â””â”€ [3-3] UpdateLeafControls()
       â”‚             â””â”€> ë¦¬í”„ ì»¨íŠ¸ë¡¤ ë¹„í™œì„±í™”
       â”‚
       â””â”€ [4] UI ì—…ë°ì´íŠ¸ ì™„ë£Œ
```

**3. ì—°ì† ì„ íƒ ì‹œí€€ìŠ¤:**
```
ì‚¬ìš©ì
  â”‚
  â”œâ”€ íƒ€ì… "KS" ì„ íƒ ì™„ë£Œ
  â”‚    â””â”€> _selectedPath = {2:"KS"}
  â”‚
  â”œâ”€ [1] ê·œê²© ì„ íƒ (ì˜ˆ: "KS B 1002:2016")
  â”‚    â”‚
  â”‚    â”œâ”€ OnHierarchySelectionChanged(3, "KS B 1002:2016")
  â”‚    â”‚    â””â”€> _selectedPath = {2:"KS", 3:"KS B 1002:2016"}
  â”‚    â”‚
  â”‚    â”œâ”€ UpdateDependentControls(3)
  â”‚    â”‚    â”‚
  â”‚    â”‚    â”œâ”€ GetAvailableValues(tree, {2:"KS", 3:"KS B 1002:2016"}, 4)
  â”‚    â”‚    â”‚   â””â”€> ["ê¸°ê³„ìš©", "PCìš©", "íŠ¹ìˆ˜ìš©"]
  â”‚    â”‚    â”‚
  â”‚    â”‚    â””â”€> ìš©ë„ ComboBox í™œì„±í™” ë° ì•„ì´í…œ ì¶”ê°€
  â”‚    â”‚
  â”‚    â””â”€ UI ì—…ë°ì´íŠ¸
  â”‚
  â”œâ”€ [2] ìš©ë„ ì„ íƒ (ì˜ˆ: "ê¸°ê³„ìš©")
  â”‚    â”‚
  â”‚    â”œâ”€ OnHierarchySelectionChanged(4, "ê¸°ê³„ìš©")
  â”‚    â”‚    â””â”€> _selectedPath = {2:"KS", 3:"KS B 1002:2016", 4:"ê¸°ê³„ìš©"}
  â”‚    â”‚
  â”‚    â”œâ”€ UpdateDependentControls(4)
  â”‚    â”‚    â”‚
  â”‚    â”‚    â”œâ”€ GetAvailableValues(tree, {..., 4:"ê¸°ê³„ìš©"}, 5)
  â”‚    â”‚    â”‚   â””â”€> ["S10C", "SS400", "SUS304", ...]
  â”‚    â”‚    â”‚
  â”‚    â”‚    â””â”€> ì¬ì§ˆ ComboBox í™œì„±í™” ë° ì•„ì´í…œ ì¶”ê°€
  â”‚    â”‚
  â”‚    â””â”€ UI ì—…ë°ì´íŠ¸
  â”‚
  â””â”€ ... ê³„ì† ì§„í–‰
```

---

## 5. ê³„ì¸µ í•„í„°ë§ ë©”ì»¤ë‹ˆì¦˜

### 5.1 í•µì‹¬ ê°œë…

**ì„ íƒ ê²½ë¡œ (Selected Path):**
```csharp
private Dictionary<int, string> _selectedPath = new Dictionary<int, string>();

// ì˜ˆì‹œ:
// íƒ€ì… ì„ íƒ: _selectedPath = {2: "KS"}
// ê·œê²© ì„ íƒ: _selectedPath = {2: "KS", 3: "KS B 1002:2016"}
// ìš©ë„ ì„ íƒ: _selectedPath = {2: "KS", 3: "KS B 1002:2016", 4: "ê¸°ê³„ìš©"}
```

**ê³„ì¸µ ì»¬ëŸ¼ (Hierarchy Columns):**
```csharp
// Headers ì¸ë±ìŠ¤ ê¸°ì¤€
var hierarchyColumns = new List<int> { 2, 3, 4, 5, 6, 7, 8 };
// 2: íƒ€ì…
// 3: ê·œê²©(í‘œì¤€ë²ˆí˜¸)
// 4: ìš©ë„
// 5: ì¬ì§ˆ
// 6: ë‚˜ì‚¬ì¢…ë¥˜
// 7: ë¨¸ë¦¬í˜•ì‹
// 8: ì‚¬ì´ì¦ˆ
```

### 5.2 í•„í„°ë§ ì•Œê³ ë¦¬ì¦˜ ìƒì„¸

**ì‹œë‚˜ë¦¬ì˜¤: íƒ€ì… "KS" ì„ íƒ í›„ ê·œê²© ì½¤ë³´ë°•ìŠ¤ ì—…ë°ì´íŠ¸**

```
1. ì´ˆê¸° ìƒíƒœ
   _selectedPath = {}
   _hierarchyTree = [ì „ì²´ íŠ¸ë¦¬]

2. íƒ€ì… "KS" ì„ íƒ
   OnHierarchySelectionChanged(2, "KS")
   â””â”€> _selectedPath = {2: "KS"}

3. UpdateDependentControls(2) í˜¸ì¶œ
   
   3-1. í•˜ìœ„ ê²½ë¡œ ì œê±°
        keysToRemove = [3, 4, 5, 6, 7, 8]
        _selectedPath = {2: "KS"}  (ë³€í™” ì—†ìŒ, ì•„ì§ í•˜ìœ„ ì„ íƒ ì—†ì—ˆìŒ)
   
   3-2. ê·œê²© ì»¬ëŸ¼ (columnIndex=3) ì²˜ë¦¬
        GetAvailableValues(_hierarchyTree, {2:"KS"}, 3)
        
        ì•Œê³ ë¦¬ì¦˜:
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ currentNodes = _hierarchyTree       â”‚
        â”‚                                     â”‚
        â”‚ foreach colIndex in [2, 3, 4, ...]: â”‚
        â”‚   if colIndex == 3 (ëª©í‘œ):          â”‚
        â”‚     return currentNodesì˜ ëª¨ë“  ê°’   â”‚
        â”‚                                     â”‚
        â”‚   if selectedPath.ContainsKey(2):   â”‚
        â”‚     value = "KS"                    â”‚
        â”‚     node = currentNodesì—ì„œ "KS" ì°¾ê¸°â”‚
        â”‚     currentNodes = node.Children    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        
        ì‹¤í–‰:
        Step 1: colIndex = 2
                selectedPath[2] = "KS"
                matchingNode = treeì—ì„œ "KS" ë…¸ë“œ
                currentNodes = matchingNode.Children
                              = [ê·œê²© ë…¸ë“œë“¤]
        
        Step 2: colIndex = 3 (ëª©í‘œ ë„ë‹¬!)
                return currentNodes.Select(n => n.Value)
                     = ["KS B 1002:2016", "KS W ISO 7913:2023"]
   
   3-3. ê·œê²© ComboBox ì—…ë°ì´íŠ¸
        comboBox.Items.Clear()
        comboBox.Items.Add("KS B 1002:2016")
        comboBox.Items.Add("KS W ISO 7913:2023")
        comboBox.IsEnabled = true

4. ê²°ê³¼: ê·œê²© ComboBox í™œì„±í™” ë° KS ê´€ë ¨ ê·œê²©ë“¤ë§Œ í‘œì‹œ
```

### 5.3 ê³„ì¸µ íŠ¸ë¦¬ êµ¬ì¡° ì‹œê°í™”

**Excel ë°ì´í„°:**
```
Row 2: íƒ€ì…=KS, ê·œê²©=KS B 1002:2016, ìš©ë„=ê¸°ê³„ìš©, ì¬ì§ˆ=S10C\nSS400\nSUS304
Row 3: íƒ€ì…=KS, ê·œê²©=KS B 1002:2016, ìš©ë„=ê¸°ê³„ìš©, ì¬ì§ˆ=ë³´í†µë‚˜ì‚¬
Row 4: íƒ€ì…=KS, ê·œê²©=KS B 1002:2016, ìš©ë„=PCìš©, ì¬ì§ˆ=PC\nRENY
Row 5: íƒ€ì…=KS, ê·œê²©=KS W ISO 7913:2023, ìš©ë„=í•­ê³µìš°ì£¼ìš©, ì¬ì§ˆ=SCM435
Row 6: íƒ€ì…=ISO, ê·œê²©=ISO 4014, ìš©ë„=ì¼ë°˜, ì¬ì§ˆ=...
```

**êµ¬ì¶•ëœ íŠ¸ë¦¬:**
```
Root
â”œâ”€ [íƒ€ì…] KS (ColumnIndex=2)
â”‚  â”œâ”€ [ê·œê²©] KS B 1002:2016 (ColumnIndex=3)
â”‚  â”‚  â”œâ”€ [ìš©ë„] ê¸°ê³„ìš© (ColumnIndex=4)
â”‚  â”‚  â”‚  â”œâ”€ [ì¬ì§ˆ] S10C (ColumnIndex=5)
â”‚  â”‚  â”‚  â”‚  â””â”€ LeafValues: {í‘œë©´ì²˜ë¦¬: ..., ë³¼íŠ¸ëë‹¨: ...}
â”‚  â”‚  â”‚  â”œâ”€ [ì¬ì§ˆ] SS400
â”‚  â”‚  â”‚  â””â”€ [ì¬ì§ˆ] SUS304
â”‚  â”‚  â”‚     â””â”€ [ë‚˜ì‚¬ì¢…ë¥˜] ë³´í†µë‚˜ì‚¬ (ColumnIndex=6)
â”‚  â”‚  â”‚        â””â”€ [ë¨¸ë¦¬í˜•ì‹] ê¸°ë³¸ (ColumnIndex=7)
â”‚  â”‚  â”‚           â””â”€ [ì‚¬ì´ì¦ˆ] M3,M4,M5,... (ColumnIndex=8)
â”‚  â”‚  â””â”€ [ìš©ë„] PCìš©
â”‚  â”‚     â”œâ”€ [ì¬ì§ˆ] PC
â”‚  â”‚     â””â”€ [ì¬ì§ˆ] RENY
â”‚  â””â”€ [ê·œê²©] KS W ISO 7913:2023
â”‚     â””â”€ [ìš©ë„] í•­ê³µìš°ì£¼ìš©
â”‚        â””â”€ [ì¬ì§ˆ] SCM435
â””â”€ [íƒ€ì…] ISO
   â””â”€ [ê·œê²©] ISO 4014
      â””â”€ [ìš©ë„] ì¼ë°˜
         â””â”€ ...
```

### 5.4 í•„í„°ë§ ì˜ˆì‹œ

**ì˜ˆì‹œ 1: íƒ€ì…ë§Œ ì„ íƒ**
```
_selectedPath = {2: "KS"}

GetAvailableValues(tree, {2:"KS"}, 3) í˜¸ì¶œ
â””â”€> ["KS B 1002:2016", "KS W ISO 7913:2023"]

GetAvailableValues(tree, {2:"KS"}, 4) í˜¸ì¶œ
â””â”€> []  // ê·œê²©ì´ ì„ íƒë˜ì§€ ì•Šì•„ ë¹ˆ ë¦¬ìŠ¤íŠ¸
```

**ì˜ˆì‹œ 2: íƒ€ì… + ê·œê²© ì„ íƒ**
```
_selectedPath = {2: "KS", 3: "KS B 1002:2016"}

GetAvailableValues(tree, {...}, 4) í˜¸ì¶œ
â””â”€> ["ê¸°ê³„ìš©", "PCìš©"]

GetAvailableValues(tree, {...}, 5) í˜¸ì¶œ
â””â”€> []  // ìš©ë„ê°€ ì„ íƒë˜ì§€ ì•Šì•„ ë¹ˆ ë¦¬ìŠ¤íŠ¸
```

**ì˜ˆì‹œ 3: íƒ€ì… + ê·œê²© + ìš©ë„ ì„ íƒ**
```
_selectedPath = {2: "KS", 3: "KS B 1002:2016", 4: "ê¸°ê³„ìš©"}

GetAvailableValues(tree, {...}, 5) í˜¸ì¶œ
â””â”€> ["S10C", "SS400", "SUS304"]
```

---

## 6. UI ë ˆì´ì•„ì›ƒ êµ¬ì¡°

### 6.1 ì „ì²´ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Menu Bar                                                     â”‚
â”‚ [íŒŒì¼] [í¸ì§‘]                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Category Panel                                               â”‚
â”‚ ì¢…ë¥˜: ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Main Content Area                                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Canvas Area                                           â”‚   â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚ â”‚ â”‚ ì‘ë„ìƒíƒœ   â”‚ Canvas 1 (ScrollViewer)           â”‚   â”‚   â”‚
â”‚ â”‚ â”‚            â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚   â”‚
â”‚ â”‚ â”‚            â”‚ â”‚ [íƒ€ì…] â–¼                        â”‚ â”‚   â”‚   â”‚
â”‚ â”‚ â”‚            â”‚ â”‚ [ê·œê²©(í‘œì¤€ë²ˆí˜¸)] â–¼             â”‚ â”‚   â”‚   â”‚
â”‚ â”‚ â”‚            â”‚ â”‚ [ìš©ë„] â–¼                        â”‚ â”‚   â”‚   â”‚
â”‚ â”‚ â”‚            â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚   â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚ â”‚ â”‚ Canvas 2 (ScrollViewer)                         â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”‚ [ì¬ì§ˆ] â–¼                                    â”‚  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”‚ [ë‚˜ì‚¬ì¢…ë¥˜(Pich)] â–¼                          â”‚  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”‚ [ë¨¸ë¦¬í˜•ì‹(Type)] â–¼                          â”‚  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”‚ [ì‚¬ì´ì¦ˆ] â˜ (ListBox)                       â”‚  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”‚ [í‘œë©´ì²˜ë¦¬] â–¼                                â”‚  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”‚ [ë³¼íŠ¸ëë‹¨] â–¼                                â”‚  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â”‚ ...                                         â”‚  â”‚   â”‚   â”‚
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚   â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Status Bar                                                   â”‚
â”‚ [ë°ì´í„° ë³´ê¸°] [ì´ˆê¸°í™”] [ì»´í¬ë„ŒíŠ¸ ì´ë™(Ctrl+M)] [ìë™ì €ì¥]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 Canvas ë°°ì¹˜ ì „ëµ

**Canvas 1: ìƒë‹¨ ì˜ì—­ (ë†’ì´ ~180px)**
- íƒ€ì…
- ê·œê²©(í‘œì¤€ë²ˆí˜¸)
- ìš©ë„ (ìƒí™©ì— ë”°ë¼ Canvas2ë¡œ ì´ë™ ê°€ëŠ¥)

**Canvas 2: í•˜ë‹¨ ì˜ì—­ (ë†’ì´ ê°€ë³€)**
- ì¬ì§ˆ
- ë‚˜ì‚¬ì¢…ë¥˜
- ë¨¸ë¦¬í˜•ì‹
- ì‚¬ì´ì¦ˆ (ListBox)
- í‘œë©´ì²˜ë¦¬
- ë³¼íŠ¸ëë‹¨
- ì „ì²´ê¸¸ì´
- ìœ íš¨ê¸¸ì´
- ê¸°íƒ€ ë¦¬í”„ ì»¨íŠ¸ë¡¤ë“¤

**Y ìœ„ì¹˜ ê³„ì‚° ë¡œì§:**
```csharp
if (currentY <= 180)
{
    targetCanvas = _canvas1;
    adjustedY = currentY;  // ê·¸ëŒ€ë¡œ ì‚¬ìš©
}
else
{
    targetCanvas = _canvas2;
    adjustedY = currentY - 180;  // Canvas2ëŠ” 0ë¶€í„° ì‹œì‘
}
```

### 6.3 ì»¨íŠ¸ë¡¤ ê·¸ë£¹í™”

**Border + StackPanel êµ¬ì¡°:**
```xml
<Border Tag="íƒ€ì…">
    <StackPanel Orientation="Vertical">
        <Label Content="íƒ€ì…" FontWeight="Bold"/>
        <ComboBox Width="200" Height="25"/>
    </StackPanel>
</Border>
```

**C# ì½”ë“œ:**
```csharp
var groupBorder = new Border
{
    Background = new SolidColorBrush(Color.FromArgb(10, 0, 0, 0)),
    BorderBrush = Brushes.Transparent,
    BorderThickness = new Thickness(1),
    Padding = new Thickness(5),
    Tag = labelText  // "íƒ€ì…", "ê·œê²©" ë“±
};

var stackPanel = new StackPanel
{
    Orientation = Orientation.Vertical
};

var label = new Label { Content = labelText, ... };
stackPanel.Children.Add(label);

var control = new ComboBox { ... };
stackPanel.Children.Add(control);

groupBorder.Child = stackPanel;
```

### 6.4 ìŠ¤ì¼€ì¼ë§ ë©”ì»¤ë‹ˆì¦˜

**ì´ˆê¸° ìœ„ì¹˜ ì €ì¥:**
```csharp
controlInfo.InitialLeft = x;
controlInfo.InitialTop = y;
controlInfo.InitialWidth = 210;
controlInfo.InitialHeight = 60;  // ComboBox
                                 // 155; // ListBox
```

**ìŠ¤ì¼€ì¼ë§ ê³„ì‚°:**
```csharp
public void ScaleControls(double scaleX, double scaleY)
{
    foreach (var kvp in _controls)
    {
        var info = kvp.Value;
        
        // ìƒˆë¡œìš´ ìœ„ì¹˜ ê³„ì‚°
        double newLeft = info.InitialLeft * scaleX;
        double newTop = info.InitialTop * scaleY;
        
        // Border ìœ„ì¹˜ ì—…ë°ì´íŠ¸
        Canvas.SetLeft(info.GroupBorder, newLeft);
        Canvas.SetTop(info.GroupBorder, newTop);
        
        // í˜„ì¬ ìœ„ì¹˜ ì €ì¥
        info.Left = newLeft;
        info.Top = newTop;
        
        // í°íŠ¸ í¬ê¸° ìŠ¤ì¼€ì¼ë§
        if (info.Label != null)
        {
            info.Label.FontSize = 11 * Math.Min(scaleX, scaleY);
        }
    }
    
    // Canvas í¬ê¸° ì¬ì¡°ì •
    AdjustCanvasSize();
}
```

**ìœˆë„ìš° í¬ê¸° ë³€ê²½ ì‹œ:**
```csharp
private void Window_SizeChanged(object sender, SizeChangedEventArgs e)
{
    if (!_isInitialized || _uiManager == null)
        return;
    
    bool isDataViewOpen = DataViewBorder.Visibility == Visibility.Visible;
    
    if (isDataViewOpen)
    {
        // ë°ì´í„° ë³´ê¸° íŒ¨ë„ ì—´ë¦¼: ì¢Œì¸¡ ì˜ì—­ ê³ ì • (670px)
        // ì»´í¬ë„ŒíŠ¸ ìŠ¤ì¼€ì¼ë§ ë¶ˆí•„ìš”
        _uiManager.RefreshCanvasSize();
    }
    else
    {
        // ë°ì´í„° ë³´ê¸° íŒ¨ë„ ë‹«í˜: ì¢Œì¸¡ ì˜ì—­ ê°€ë³€
        // ì»´í¬ë„ŒíŠ¸ ë¹„ë¡€ ìŠ¤ì¼€ì¼ë§
        double scaleX = e.NewSize.Width / INITIAL_WIDTH;
        double scaleY = e.NewSize.Height / INITIAL_HEIGHT;
        _uiManager.ScaleControls(scaleX, scaleY);
    }
}
```

---

## 7. ì´ë²¤íŠ¸ ì²˜ë¦¬ íë¦„

### 7.1 ì´ë²¤íŠ¸ ì¢…ë¥˜

**1. UI ì´ë²¤íŠ¸:**
- Menu Item Click (íŒŒì¼ ì—´ê¸°, ì €ì¥, ë¶ˆëŸ¬ì˜¤ê¸°)
- Window SizeChanged
- ComboBox SelectionChanged
- ListBox SelectionChanged
- Button Click

**2. í‚¤ë³´ë“œ ì´ë²¤íŠ¸:**
- Ctrl+M: ì»¨íŠ¸ë¡¤ ì´ë™ ëª¨ë“œ í† ê¸€
- Ctrl+S: ìœ„ì¹˜ ì €ì¥
- Shift+Click: Canvas ê°„ ì´ë™

**3. ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸:**
- MouseDown: ë“œë˜ê·¸ ì‹œì‘
- MouseMove: ë“œë˜ê·¸ ì¤‘
- MouseUp: ë“œë˜ê·¸ ì¢…ë£Œ

### 7.2 ComboBox SelectionChanged ì´ë²¤íŠ¸

**ì´ë²¤íŠ¸ ì—°ê²°:**
```csharp
// CreateDynamicControl ë©”ì„œë“œì—ì„œ
comboBox.SelectionChanged += (s, e) =>
{
    OnHierarchySelectionChanged(columnIndex, comboBox.SelectedItem?.ToString());
};
```

**ì´ë²¤íŠ¸ íë¦„:**
```
ì‚¬ìš©ì ì„ íƒ
    â†“
ComboBox.SelectionChanged ë°œìƒ
    â†“
Lambda í•¨ìˆ˜ ì‹¤í–‰
    â†“
OnHierarchySelectionChanged(columnIndex, selectedValue)
    â”œâ”€ _selectedPath ì—…ë°ì´íŠ¸
    â””â”€ UpdateDependentControls(columnIndex)
        â”œâ”€ í•˜ìœ„ ê²½ë¡œ ì œê±°
        â”œâ”€ ê° í•˜ìœ„ ì»¨íŠ¸ë¡¤ ì—…ë°ì´íŠ¸
        â”‚   â”œâ”€ GetAvailableValues() í˜¸ì¶œ
        â”‚   â”œâ”€ ComboBox.Items.Clear()
        â”‚   â”œâ”€ ComboBox.Items.Add(...)
        â”‚   â””â”€ ComboBox.IsEnabled ì„¤ì •
        â””â”€ UpdateLeafControls()
            â””â”€ ë¦¬í”„ ì»¨íŠ¸ë¡¤ í™œì„±í™”/ë¹„í™œì„±í™”
```

### 7.3 ì»¨íŠ¸ë¡¤ ì´ë™ ëª¨ë“œ

**Ctrl+M í‚¤ ì²˜ë¦¬:**
```csharp
protected override void OnKeyDown(KeyEventArgs e)
{
    if (e.Key == Key.M && Keyboard.Modifiers == ModifierKeys.Control)
    {
        _isControlMoveMode = !_isControlMoveMode;
        
        if (_isControlMoveMode)
        {
            // ì´ë™ ëª¨ë“œ ì§„ì…
            _uiManager.EnterControlMoveMode();
            StatusText.Text = "ì»¨íŠ¸ë¡¤ ì´ë™ ëª¨ë“œ í™œì„±í™”";
        }
        else
        {
            // ì´ë™ ëª¨ë“œ í•´ì œ
            _uiManager.ExitControlMoveMode();
            StatusText.Text = "ì»¨íŠ¸ë¡¤ ì´ë™ ëª¨ë“œ ë¹„í™œì„±í™”";
        }
    }
}
```

**ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ ì²˜ë¦¬:**
```csharp
// DynamicUIManager.EnterControlMoveMode()ì—ì„œ ì´ë²¤íŠ¸ ì—°ê²°
groupBorder.MouseDown += (s, e) =>
{
    if (_mainWindow.IsControlMoveMode)
    {
        _isDragging = true;
        _draggedBorder = s as Border;
        _dragStartPoint = e.GetPosition(_canvas1.Parent as UIElement);
        _draggedBorder.CaptureMouse();
        e.Handled = true;
    }
};

groupBorder.MouseMove += (s, e) =>
{
    if (_isDragging && _draggedBorder != null)
    {
        var currentPoint = e.GetPosition(_canvas1.Parent as UIElement);
        var offset = currentPoint - _dragStartPoint;
        
        // ìƒˆ ìœ„ì¹˜ ê³„ì‚°
        double newLeft = Canvas.GetLeft(_draggedBorder) + offset.X;
        double newTop = Canvas.GetTop(_draggedBorder) + offset.Y;
        
        // ìœ„ì¹˜ ì—…ë°ì´íŠ¸
        Canvas.SetLeft(_draggedBorder, newLeft);
        Canvas.SetTop(_draggedBorder, newTop);
        
        _dragStartPoint = currentPoint;
    }
};

groupBorder.MouseUp += (s, e) =>
{
    if (_isDragging)
    {
        _isDragging = false;
        _draggedBorder?.ReleaseMouseCapture();
        _draggedBorder = null;
    }
};
```

**Shift+Click Canvas ì´ë™:**
```csharp
groupBorder.MouseDown += (s, e) =>
{
    if (_mainWindow.IsControlMoveMode && Keyboard.Modifiers == ModifierKeys.Shift)
    {
        var border = s as Border;
        var controlName = border.Tag as string;
        var info = _controls[controlName];
        
        // Canvas ì „í™˜
        if (info.CanvasNumber == 1)
        {
            // Canvas1 â†’ Canvas2
            _canvas1.Children.Remove(border);
            _canvas2.Children.Add(border);
            info.CanvasNumber = 2;
        }
        else
        {
            // Canvas2 â†’ Canvas1
            _canvas2.Children.Remove(border);
            _canvas1.Children.Add(border);
            info.CanvasNumber = 1;
        }
        
        e.Handled = true;
    }
};
```

---

## 8. ì €ì¥/ë¡œë“œ ë©”ì»¤ë‹ˆì¦˜

### 8.1 JSON ì €ì¥ êµ¬ì¡°

**ì €ì¥ë˜ëŠ” ë°ì´í„°:**
```json
{
  "controls": [
    {
      "ColumnName": "íƒ€ì…",
      "ColumnIndex": 2,
      "Type": "ComboBox",
      "Items": ["KS", "ISO", "DIN"],
      "SelectedValue": "KS",
      "IsEnabled": true,
      "Left": 10.0,
      "Top": 10.0,
      "Width": 210.0,
      "Height": 60.0,
      "InitialLeft": 10.0,
      "InitialTop": 10.0,
      "InitialWidth": 210.0,
      "InitialHeight": 60.0,
      "CanvasNumber": 1
    },
    {
      "ColumnName": "ê·œê²©(í‘œì¤€ë²ˆí˜¸)",
      "ColumnIndex": 3,
      "Type": "ComboBox",
      "Items": ["KS B 1002:2016", "KS W ISO 7913:2023"],
      "SelectedValue": "KS B 1002:2016",
      "IsEnabled": true,
      "Left": 10.0,
      "Top": 70.0,
      ...
    }
  ],
  "selectedPath": {
    "2": "KS",
    "3": "KS B 1002:2016",
    "4": "ê¸°ê³„ìš©"
  }
}
```

### 8.2 ì €ì¥ í”„ë¡œì„¸ìŠ¤

```csharp
private void Save_Click(object sender, RoutedEventArgs e)
{
    try
    {
        // 1. í˜„ì¬ ì»¨íŠ¸ë¡¤ ìƒíƒœ ìˆ˜ì§‘
        var controlsData = new List<Dictionary<string, object>>();
        
        foreach (var kvp in _uiManager.GetControls())
        {
            var info = kvp.Value;
            var controlData = new Dictionary<string, object>
            {
                ["ColumnName"] = info.ColumnName,
                ["ColumnIndex"] = info.ColumnIndex,
                ["Type"] = info.Type.ToString(),
                ["SelectedValue"] = GetSelectedValue(info.Control),
                ["IsEnabled"] = info.Control.IsEnabled,
                ["Left"] = info.Left,
                ["Top"] = info.Top,
                ["Width"] = info.Width,
                ["Height"] = info.Height,
                ["InitialLeft"] = info.InitialLeft,
                ["InitialTop"] = info.InitialTop,
                ["InitialWidth"] = info.InitialWidth,
                ["InitialHeight"] = info.InitialHeight,
                ["CanvasNumber"] = info.CanvasNumber
            };
            
            // ComboBox/ListBox ì•„ì´í…œ ì €ì¥
            if (info.Control is ComboBox cb)
            {
                controlData["Items"] = cb.Items.Cast<string>().ToList();
            }
            else if (info.Control is ListBox lb)
            {
                controlData["Items"] = lb.Items.Cast<string>().ToList();
                controlData["SelectedItems"] = lb.SelectedItems.Cast<string>().ToList();
            }
            
            controlsData.Add(controlData);
        }
        
        // 2. ì„ íƒ ê²½ë¡œ ì €ì¥
        var selectedPath = _uiManager.GetSelectedPath();
        
        // 3. JSON ì§ë ¬í™”
        var saveData = new Dictionary<string, object>
        {
            ["controls"] = controlsData,
            ["selectedPath"] = selectedPath
        };
        
        var json = JsonConvert.SerializeObject(saveData, Formatting.Indented);
        
        // 4. íŒŒì¼ ì €ì¥ ë‹¤ì´ì–¼ë¡œê·¸
        var dialog = new SaveFileDialog
        {
            Filter = "JSON files (*.json)|*.json|All files (*.*)|*.*",
            DefaultExt = "json"
        };
        
        if (dialog.ShowDialog() == true)
        {
            File.WriteAllText(dialog.FileName, json);
            MessageBox.Show("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.", "ì €ì¥ ì™„ë£Œ");
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show($"ì €ì¥ ì‹¤íŒ¨: {ex.Message}", "ì˜¤ë¥˜");
    }
}
```

### 8.3 ë¡œë“œ í”„ë¡œì„¸ìŠ¤

```csharp
private void Load_Click(object sender, RoutedEventArgs e)
{
    try
    {
        // 1. íŒŒì¼ ì„ íƒ ë‹¤ì´ì–¼ë¡œê·¸
        var dialog = new OpenFileDialog
        {
            Filter = "JSON files (*.json)|*.json|All files (*.*)|*.*"
        };
        
        if (dialog.ShowDialog() != true)
            return;
        
        // 2. JSON ì½ê¸° ë° íŒŒì‹±
        var json = File.ReadAllText(dialog.FileName);
        var loadData = JsonConvert.DeserializeObject<Dictionary<string, object>>(json);
        
        // 3. ì»¨íŠ¸ë¡¤ ìƒíƒœ ë³µì›
        var controlsData = JsonConvert.DeserializeObject<List<Dictionary<string, object>>>(
            loadData["controls"].ToString());
        
        foreach (var controlData in controlsData)
        {
            var columnName = controlData["ColumnName"].ToString();
            
            if (_uiManager.GetControls().ContainsKey(columnName))
            {
                var info = _uiManager.GetControls()[columnName];
                
                // ìœ„ì¹˜ ë³µì›
                info.Left = Convert.ToDouble(controlData["Left"]);
                info.Top = Convert.ToDouble(controlData["Top"]);
                Canvas.SetLeft(info.GroupBorder, info.Left);
                Canvas.SetTop(info.GroupBorder, info.Top);
                
                // Canvas ë²ˆí˜¸ ë³µì›
                int savedCanvas = Convert.ToInt32(controlData["CanvasNumber"]);
                if (savedCanvas != info.CanvasNumber)
                {
                    // Canvas ì „í™˜
                    _uiManager.MoveControlToCanvas(columnName, savedCanvas);
                }
                
                // ComboBox/ListBox ì•„ì´í…œ ë° ì„ íƒ ë³µì›
                if (info.Control is ComboBox cb && controlData.ContainsKey("SelectedValue"))
                {
                    var selectedValue = controlData["SelectedValue"]?.ToString();
                    if (!string.IsNullOrEmpty(selectedValue) && cb.Items.Contains(selectedValue))
                    {
                        cb.SelectedItem = selectedValue;
                    }
                }
                else if (info.Control is ListBox lb && controlData.ContainsKey("SelectedItems"))
                {
                    var selectedItems = JsonConvert.DeserializeObject<List<string>>(
                        controlData["SelectedItems"].ToString());
                    
                    lb.SelectedItems.Clear();
                    foreach (var item in selectedItems)
                    {
                        if (lb.Items.Contains(item))
                            lb.SelectedItems.Add(item);
                    }
                }
            }
        }
        
        // 4. ì„ íƒ ê²½ë¡œ ë³µì›
        if (loadData.ContainsKey("selectedPath"))
        {
            var selectedPath = JsonConvert.DeserializeObject<Dictionary<string, string>>(
                loadData["selectedPath"].ToString());
            
            _uiManager.RestoreSelectedPath(selectedPath);
        }
        
        MessageBox.Show("ë¶ˆëŸ¬ì˜¤ê¸° ì™„ë£Œ", "ì™„ë£Œ");
    }
    catch (Exception ex)
    {
        MessageBox.Show($"ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: {ex.Message}", "ì˜¤ë¥˜");
    }
}
```

### 8.4 ìë™ ì €ì¥ (Registry)

**ìœ„ì¹˜ ì •ë³´ ì €ì¥:**
```csharp
public void SaveControlPositions()
{
    var settingsData = new Dictionary<string, object>();
    var controlsData = new List<Dictionary<string, object>>();
    
    foreach (var kvp in _controls)
    {
        controlsData.Add(new Dictionary<string, object>
        {
            ["ColumnName"] = kvp.Value.ColumnName,
            ["Left"] = kvp.Value.Left,
            ["Top"] = kvp.Value.Top,
            ["CanvasNumber"] = kvp.Value.CanvasNumber
        });
    }
    
    settingsData["controls"] = controlsData;
    
    var json = JsonConvert.SerializeObject(settingsData);
    File.WriteAllText(SETTINGS_FILE, json);
}
```

**ìœ„ì¹˜ ì •ë³´ ë³µì›:**
```csharp
// MainWindowì—ì„œ UI êµ¬ì¶• í›„ ìë™ ë¡œë“œ
if (File.Exists(SETTINGS_FILE))
{
    var json = File.ReadAllText(SETTINGS_FILE);
    var loadData = JsonConvert.DeserializeObject<Dictionary<string, object>>(json);
    
    if (loadData.ContainsKey("controls"))
    {
        _uiManager.RestoreControlPositions(loadData["controls"].ToString());
    }
}
```

---

## 9. í™•ì¥ ê°€ëŠ¥ì„±

### 9.1 ìƒˆë¡œìš´ ì»¬ëŸ¼ íƒ€ì… ì¶”ê°€

**í˜„ì¬ ì§€ì›í•˜ëŠ” íƒ€ì…:**
```csharp
public enum ControlType
{
    ComboBox,   // ë‹¨ì¼ ì„ íƒ
    ListBox,    // ë‹¤ì¤‘ ì„ íƒ
    EditBox,    // í…ìŠ¤íŠ¸ ì…ë ¥
    CheckBox,   // ì²´í¬ë°•ìŠ¤
    Label       // ë¼ë²¨
}
```

**ì¶”ê°€ ê°€ëŠ¥í•œ íƒ€ì…:**
```csharp
public enum ControlType
{
    // ê¸°ì¡´
    ComboBox, ListBox, EditBox, CheckBox, Label,
    
    // ìƒˆë¡œìš´ íƒ€ì…
    NumericUpDown,     // ìˆ«ì ì…ë ¥
    DatePicker,        // ë‚ ì§œ ì„ íƒ
    ColorPicker,       // ìƒ‰ìƒ ì„ íƒ
    Slider,            // ìŠ¬ë¼ì´ë”
    RadioButtonGroup,  // ë¼ë””ì˜¤ ë²„íŠ¼ ê·¸ë£¹
    MultiLineTextBox   // ì—¬ëŸ¬ ì¤„ í…ìŠ¤íŠ¸
}
```

**êµ¬í˜„ ë°©ë²•:**
```csharp
// CreateControlWithLabel ë©”ì„œë“œì— case ì¶”ê°€
switch (type)
{
    case ControlType.ComboBox:
        control = new ComboBox { Width = 200, Height = 25 };
        break;
    
    // ìƒˆë¡œìš´ íƒ€ì…
    case ControlType.NumericUpDown:
        control = new NumericUpDown 
        { 
            Width = 200, 
            Height = 25,
            Minimum = 0,
            Maximum = 1000
        };
        controlInfo.Height = 60;
        controlInfo.InitialHeight = 60;
        break;
    
    case ControlType.DatePicker:
        control = new DatePicker { Width = 200, Height = 25 };
        controlInfo.Height = 60;
        controlInfo.InitialHeight = 60;
        break;
}
```

### 9.2 ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€

**êµ¬í˜„ ì•„ì´ë””ì–´:**
```csharp
public class DynamicUIManager
{
    // ê²€ìƒ‰ í…ìŠ¤íŠ¸ë°•ìŠ¤ ì¶”ê°€
    private TextBox _searchBox;
    
    public void AddSearchFeature()
    {
        _searchBox = new TextBox
        {
            Width = 200,
            Height = 25,
            Margin = new Thickness(10)
        };
        
        _searchBox.TextChanged += (s, e) =>
        {
            var searchText = _searchBox.Text.ToLower();
            FilterControlsBySearch(searchText);
        };
        
        // MainWindowì˜ ìƒë‹¨ì— ì¶”ê°€
        _mainWindow.SearchPanel.Children.Add(_searchBox);
    }
    
    private void FilterControlsBySearch(string searchText)
    {
        foreach (var kvp in _controls)
        {
            var info = kvp.Value;
            bool isMatch = info.ColumnName.ToLower().Contains(searchText);
            
            // ì¼ì¹˜í•˜ì§€ ì•Šìœ¼ë©´ íˆ¬ëª…ë„ ë‚®ì¶¤
            info.GroupBorder.Opacity = isMatch ? 1.0 : 0.3;
        }
    }
}
```

### 9.3 ë©€í‹° ì–¸ì–´ ì§€ì›

**êµ¬í˜„ ë°©ë²•:**
```csharp
public class LanguageManager
{
    private Dictionary<string, Dictionary<string, string>> _translations;
    private string _currentLanguage = "ko";
    
    public LanguageManager()
    {
        _translations = new Dictionary<string, Dictionary<string, string>>
        {
            ["ko"] = new Dictionary<string, string>
            {
                ["File"] = "íŒŒì¼",
                ["Open"] = "ì—´ê¸°",
                ["Save"] = "ì €ì¥",
                ["Type"] = "íƒ€ì…",
                ["Standard"] = "ê·œê²©(í‘œì¤€ë²ˆí˜¸)",
                // ...
            },
            ["en"] = new Dictionary<string, string>
            {
                ["File"] = "File",
                ["Open"] = "Open",
                ["Save"] = "Save",
                ["Type"] = "Type",
                ["Standard"] = "Standard No.",
                // ...
            }
        };
    }
    
    public string Translate(string key)
    {
        if (_translations.ContainsKey(_currentLanguage) &&
            _translations[_currentLanguage].ContainsKey(key))
        {
            return _translations[_currentLanguage][key];
        }
        return key;
    }
    
    public void ChangeLanguage(string languageCode)
    {
        _currentLanguage = languageCode;
        // UI ê°±ì‹  ì´ë²¤íŠ¸ ë°œìƒ
        OnLanguageChanged?.Invoke();
    }
}
```

### 9.4 ìœ íš¨ì„± ê²€ì‚¬ ì¶”ê°€

**êµ¬í˜„ ë°©ë²•:**
```csharp
public class ValidationManager
{
    private Dictionary<string, Func<string, bool>> _validators;
    
    public ValidationManager()
    {
        _validators = new Dictionary<string, Func<string, bool>>();
    }
    
    public void AddValidator(string columnName, Func<string, bool> validator)
    {
        _validators[columnName] = validator;
    }
    
    public bool Validate(string columnName, string value)
    {
        if (_validators.ContainsKey(columnName))
        {
            return _validators[columnName](value);
        }
        return true;  // ê²€ì¦ê¸°ê°€ ì—†ìœ¼ë©´ í†µê³¼
    }
}

// ì‚¬ìš© ì˜ˆì‹œ
var validationManager = new ValidationManager();

// ì‚¬ì´ì¦ˆëŠ” Mìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ìˆ«ìì—¬ì•¼ í•¨
validationManager.AddValidator("ì‚¬ì´ì¦ˆ", (value) =>
{
    return value.StartsWith("M") && int.TryParse(value.Substring(1), out _);
});

// ì „ì²´ê¸¸ì´ëŠ” ìˆ«ìì—¬ì•¼ í•¨
validationManager.AddValidator("ì „ì²´ê¸¸ì´", (value) =>
{
    return double.TryParse(value, out _);
});
```

### 9.5 Export ê¸°ëŠ¥

**PDF Export:**
```csharp
public void ExportToPdf(string filePath)
{
    var document = new PdfDocument();
    var page = document.AddPage();
    var graphics = XGraphics.FromPdfPage(page);
    var font = new XFont("Arial", 12);
    
    double y = 50;
    
    // ì¢…ë¥˜ í‘œì‹œ
    graphics.DrawString($"ì¢…ë¥˜: {_categoryValue}", font, XBrushes.Black, 
                       new XPoint(50, y));
    y += 30;
    
    // ì„ íƒëœ ê°’ë“¤ í‘œì‹œ
    foreach (var kvp in _selectedPath)
    {
        var columnName = _data.Headers[kvp.Key];
        var value = kvp.Value;
        graphics.DrawString($"{columnName}: {value}", font, XBrushes.Black, 
                           new XPoint(50, y));
        y += 20;
    }
    
    document.Save(filePath);
}
```

**Excel Export:**
```csharp
public void ExportToExcel(string filePath)
{
    using (var package = new ExcelPackage())
    {
        var worksheet = package.Workbook.Worksheets.Add("ì„ íƒ ì •ë³´");
        
        int row = 1;
        
        // í—¤ë”
        worksheet.Cells[row, 1].Value = "ì»¬ëŸ¼ëª…";
        worksheet.Cells[row, 2].Value = "ì„ íƒê°’";
        row++;
        
        // ë°ì´í„°
        foreach (var kvp in _selectedPath)
        {
            var columnName = _data.Headers[kvp.Key];
            var value = kvp.Value;
            
            worksheet.Cells[row, 1].Value = columnName;
            worksheet.Cells[row, 2].Value = value;
            row++;
        }
        
        package.SaveAs(new FileInfo(filePath));
    }
}
```

### 9.6 ì‹¤ì‹œê°„ ë™ê¸°í™”

**ë‹¤ì¤‘ ì‚¬ìš©ì ì§€ì›:**
```csharp
public class SyncManager
{
    private WebSocket _webSocket;
    
    public void Connect(string serverUrl)
    {
        _webSocket = new WebSocket(serverUrl);
        
        _webSocket.OnMessage += (sender, e) =>
        {
            var message = JsonConvert.DeserializeObject<SyncMessage>(e.Data);
            HandleSyncMessage(message);
        };
        
        _webSocket.Connect();
    }
    
    public void BroadcastSelection(int columnIndex, string value)
    {
        var message = new SyncMessage
        {
            Type = "selection",
            ColumnIndex = columnIndex,
            Value = value,
            Timestamp = DateTime.Now
        };
        
        var json = JsonConvert.SerializeObject(message);
        _webSocket.Send(json);
    }
    
    private void HandleSyncMessage(SyncMessage message)
    {
        // ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ì„ íƒ ë°˜ì˜
        if (message.Type == "selection")
        {
            _uiManager.UpdateControlFromRemote(message.ColumnIndex, message.Value);
        }
    }
}
```

---

## 10. ì„±ëŠ¥ ìµœì í™” ì „ëµ

### 10.1 í˜„ì¬ ì„±ëŠ¥ íŠ¹ì„±

**íŠ¸ë¦¬ êµ¬ì¶• ë³µì¡ë„:**
- ì‹œê°„: O(N * M) - N: í–‰ ìˆ˜, M: ê³„ì¸µ ê¹Šì´
- ê³µê°„: O(N * M)

**í•„í„°ë§ ë³µì¡ë„:**
- ì‹œê°„: O(D) - D: íŠ¸ë¦¬ ê¹Šì´ (ì¼ë°˜ì ìœ¼ë¡œ < 10)
- ê³µê°„: O(1)

### 10.2 ìµœì í™” ê¸°ë²•

**1. ì§€ì—° ë¡œë”© (Lazy Loading):**
```csharp
public class HierarchyNode
{
    private List<HierarchyNode> _children;
    private bool _childrenLoaded = false;
    
    public List<HierarchyNode> Children
    {
        get
        {
            if (!_childrenLoaded)
            {
                LoadChildren();
                _childrenLoaded = true;
            }
            return _children;
        }
    }
    
    private void LoadChildren()
    {
        // í•„ìš”í•  ë•Œë§Œ ìì‹ ë…¸ë“œ ë¡œë“œ
        _children = BuildChildrenFromData();
    }
}
```

**2. ìºì‹±:**
```csharp
public class HierarchyTreeBuilder
{
    private Dictionary<string, List<string>> _cachedValues = 
        new Dictionary<string, List<string>>();
    
    public List<string> GetAvailableValues(
        List<HierarchyNode> tree, 
        Dictionary<int, string> selectedPath, 
        int targetColumnIndex)
    {
        // ìºì‹œ í‚¤ ìƒì„±
        var cacheKey = GenerateCacheKey(selectedPath, targetColumnIndex);
        
        if (_cachedValues.ContainsKey(cacheKey))
        {
            return _cachedValues[cacheKey];
        }
        
        // ê³„ì‚°
        var values = ComputeAvailableValues(tree, selectedPath, targetColumnIndex);
        
        // ìºì‹œ ì €ì¥
        _cachedValues[cacheKey] = values;
        
        return values;
    }
    
    private string GenerateCacheKey(Dictionary<int, string> path, int target)
    {
        var sortedKeys = path.Keys.OrderBy(k => k);
        var keyParts = sortedKeys.Select(k => $"{k}:{path[k]}");
        return $"{string.Join("|", keyParts)}|{target}";
    }
}
```

**3. ê°€ìƒí™” (Virtualization):**
```xml
<!-- ListBoxë¥¼ VirtualizingStackPanelë¡œ ê°ì‹¸ê¸° -->
<ListBox VirtualizingPanel.IsVirtualizing="True"
         VirtualizingPanel.VirtualizationMode="Recycling">
    <!-- ... -->
</ListBox>
```

**4. ë¹„ë™ê¸° ì²˜ë¦¬:**
```csharp
public async Task<BoltSpecData> ReadExcelAsync(string filePath)
{
    return await Task.Run(() =>
    {
        // Excel ì½ê¸°ë¥¼ ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰
        return ReadExcel(filePath);
    });
}

private async void OpenExcel_Click(object sender, RoutedEventArgs e)
{
    // UI ë¸”ë¡œí‚¹ ë°©ì§€
    var data = await _excelReader.ReadExcelAsync(filePath);
    _data = data;
    _uiManager.BuildUI(_data);
}
```

---

## ğŸ“Œ ìš”ì•½

### í•µì‹¬ ì•„í‚¤í…ì²˜ íŠ¹ì§•

1. **ê³„ì¸µí™”ëœ êµ¬ì¡°**
   - Presentation, UI Manager, Business Logic, Data ê³„ì¸µ ë¶„ë¦¬
   - ê° ê³„ì¸µì€ ëª…í™•í•œ ì±…ì„ê³¼ ì¸í„°í˜ì´ìŠ¤

2. **ë™ì  UI ìƒì„±**
   - Excel ë°ì´í„° ê¸°ë°˜ ì™„ì „ ë™ì  ìƒì„±
   - í•˜ë“œì½”ë”© ìµœì†Œí™”

3. **ê³„ì¸µ í•„í„°ë§**
   - íŠ¸ë¦¬ ê¸°ë°˜ íš¨ìœ¨ì  í•„í„°ë§
   - O(D) ë³µì¡ë„ë¡œ ë¹ ë¥¸ ê²€ìƒ‰

4. **ìœ ì—°í•œ ë ˆì´ì•„ì›ƒ**
   - Canvas ê¸°ë°˜ ììœ  ë°°ì¹˜
   - ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë™
   - ìë™ ìŠ¤ì¼€ì¼ë§

5. **ë°ì´í„° ì˜ì†ì„±**
   - JSON ê¸°ë°˜ ì €ì¥/ë¡œë“œ
   - ìœ„ì¹˜ ì •ë³´ ìë™ ì €ì¥

6. **í™•ì¥ ê°€ëŠ¥í•œ ì„¤ê³„**
   - ìƒˆë¡œìš´ ì»¨íŠ¸ë¡¤ íƒ€ì… ì‰½ê²Œ ì¶”ê°€
   - í”ŒëŸ¬ê·¸ì¸ êµ¬ì¡° ê°€ëŠ¥
   - ë‹¤ì–‘í•œ ê¸°ëŠ¥ í™•ì¥ ê°€ëŠ¥

---

ì´ ì•„í‚¤í…ì²˜ëŠ” **ìœ ì§€ë³´ìˆ˜ì„±**, **í™•ì¥ì„±**, **ì„±ëŠ¥**ì„ ëª¨ë‘ ê³ ë ¤í•œ ê²¬ê³ í•œ ì„¤ê³„ì…ë‹ˆë‹¤. ğŸ’ª
