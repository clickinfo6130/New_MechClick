# JSON ë‚´ë³´ë‚´ê¸° ê¸°ëŠ¥ ê°€ì´ë“œ

## ğŸ“‹ ê°œìš”

Excel ë°ì´í„°ë¥¼ ê³„ì¸µ êµ¬ì¡°ì— ë§ê²Œ JSON íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.
ê° ì»¬ëŸ¼ê³¼ ì•„ì´í…œì— ê³ ìœ  IDê°€ ë¶€ì—¬ë˜ë©°, í•„í„°ë§ ê´€ê³„ê°€ í•¨ê»˜ ì €ì¥ë©ë‹ˆë‹¤.

---

## ğŸ¯ ì‚¬ìš© ë°©ë²•

### ë©”ë‰´ì—ì„œ ì‹¤í–‰
```
íŒŒì¼ â†’ JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°
```

### ë‹¨ì¶•í‚¤
- ì—†ìŒ (ë©”ë‰´ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥)

---

## ğŸ“Š JSON êµ¬ì¡°

### ì „ì²´ êµ¬ì¡°
```json
{
  "Series": [
    {
      "name": "ì‹œë¦¬ì¦ˆ ì´ë¦„ (ì¢…ë¥˜)",
      "id": 1,
      "option": [ ... ]
    }
  ]
}
```

### Option (ì˜µì…˜) êµ¬ì¡°
```json
{
  "id": 0,                    // ì˜µì…˜ ê³ ìœ  ID (0ë¶€í„° ìˆœì°¨)
  "name": "íƒ€ì…",             // ì»¬ëŸ¼ëª…
  "default_Value": "0",       // ê¸°ë³¸ ì„ íƒê°’
  "values": [ ... ],          // ê°’ ëª©ë¡
  "type": "COMBO"             // ì»¨íŠ¸ë¡¤ íƒ€ì…
}
```

### OptionValue (ê°’) êµ¬ì¡°
```json
{
  "enumid": 0,                // ê°’ ê³ ìœ  ID
  "name": "KS",               // ê°’ ì´ë¦„
  "desc": "",                 // ì„¤ëª…
  "filter": ["0"],            // ì˜í–¥ ë°›ëŠ” ì˜µì…˜ ID
  "filter_Values": [["0"]]    // ì˜í–¥ ë°›ëŠ” ì˜µì…˜ì˜ ê°’ ID
}
```

---

## ğŸ”— í•„í„°ë§ ê´€ê³„ ì„¤ëª…

### filter í•„ë“œ
- í˜„ì¬ ê°’ì´ **ì˜ì¡´í•˜ëŠ” ìƒìœ„ ì˜µì…˜ì˜ ID**
- `"-1"`: ìƒìœ„ ì˜µì…˜ ì—†ìŒ (ìµœìƒìœ„ ê³„ì¸µ)
- `"0"`: ì˜µì…˜ ID 0ë²ˆ (íƒ€ì…)ì— ì˜ì¡´
- `"1"`: ì˜µì…˜ ID 1ë²ˆ (ê·œê²©)ì— ì˜ì¡´

### filter_Values í•„ë“œ
- í˜„ì¬ ê°’ì´ **í™œì„±í™”ë˜ëŠ” ì¡°ê±´** (ìƒìœ„ ì˜µì…˜ì˜ ê°’ ID)
- `[["-1"]]`: í•­ìƒ í™œì„±í™”
- `[["0"]]`: ìƒìœ„ ì˜µì…˜ì—ì„œ enumid=0 ì„ íƒ ì‹œ í™œì„±í™”
- `[["0", "1"]]`: ìƒìœ„ ì˜µì…˜ì—ì„œ enumid=0 ë˜ëŠ” 1 ì„ íƒ ì‹œ í™œì„±í™”

### ì˜ˆì‹œ
```json
// íƒ€ì… ì˜µì…˜ (ìµœìƒìœ„ - í•„í„° ì—†ìŒ)
{
  "id": 0,
  "name": "íƒ€ì…",
  "values": [
    {
      "enumid": 0,
      "name": "KS",
      "filter": ["-1"],          // ìƒìœ„ ì—†ìŒ
      "filter_Values": [["-1"]]  // í•­ìƒ í‘œì‹œ
    },
    {
      "enumid": 1,
      "name": "JIS",
      "filter": ["-1"],
      "filter_Values": [["-1"]]
    }
  ]
}

// ê·œê²© ì˜µì…˜ (íƒ€ì…ì— ì˜ì¡´)
{
  "id": 1,
  "name": "ê·œê²©(í‘œì¤€ë²ˆí˜¸)",
  "values": [
    {
      "enumid": 0,
      "name": "KS B 1002:2016",
      "filter": ["0"],           // íƒ€ì…(id=0)ì— ì˜ì¡´
      "filter_Values": [["0"]]   // íƒ€ì…ì—ì„œ KS(enumid=0) ì„ íƒ ì‹œ í‘œì‹œ
    },
    {
      "enumid": 1,
      "name": "JIS B 1180:2014",
      "filter": ["0"],           // íƒ€ì…(id=0)ì— ì˜ì¡´
      "filter_Values": [["1"]]   // íƒ€ì…ì—ì„œ JIS(enumid=1) ì„ íƒ ì‹œ í‘œì‹œ
    }
  ]
}
```

---

## ğŸ·ï¸ ì»¨íŠ¸ë¡¤ íƒ€ì… (type)

| íƒ€ì… | ì„¤ëª… | Excel ê°’ |
|------|------|---------|
| `COMBO` | ë“œë¡­ë‹¤ìš´ ì½¤ë³´ë°•ìŠ¤ | (ì¼ë°˜ ê°’) |
| `LISTBOX` | ë‹¤ì¤‘ ì„ íƒ ë¦¬ìŠ¤íŠ¸ | ì‚¬ì´ì¦ˆ ì»¬ëŸ¼ |
| `EDITBOX` | í…ìŠ¤íŠ¸ ì…ë ¥ | E |
| `CHECKBOX` | ì²´í¬ë°•ìŠ¤ | C |

---

## ğŸ“ ì»¬ëŸ¼ ë§¤í•‘

### Excel ì»¬ëŸ¼ â†’ JSON ì˜µì…˜

| Excel ì»¬ëŸ¼ | ì¸ë±ìŠ¤ | JSON Option ID | ë¹„ê³  |
|-----------|--------|----------------|------|
| ë¶„ë¥˜ | 0 | - | ì œì™¸ |
| ì¢…ë¥˜ | 1 | Series.name | ì‹œë¦¬ì¦ˆ ì´ë¦„ |
| íƒ€ì… | 2 | 0 | ê³„ì¸µ ì‹œì‘ |
| ê·œê²©(í‘œì¤€ë²ˆí˜¸) | 3 | 1 | |
| ìš©ë„ | 4 | 2 | |
| ì¬ì§ˆ | 5 | 3 | |
| ë‚˜ì‚¬ì¢…ë¥˜(Pich) | 6 | 4 | |
| ë¨¸ë¦¬í˜•ì‹(Type) | 7 | 5 | |
| ì‚¬ì´ì¦ˆ | 8 | 6 | LISTBOX |
| í‘œë©´ì²˜ë¦¬ | 9 | 7 | ë¦¬í”„ ì‹œì‘ |
| ë³¼íŠ¸ëë‹¨ | 10 | 8 | |
| ì „ì²´ê¸¸ì´ | 11 | 9 | EDITBOX |
| ìœ íš¨ê¸¸ì´ | 12 | 10 | EDITBOX |

---

## ğŸ“ ID ë¶€ì—¬ ê·œì¹™

### Series ID
- 1ë¶€í„° ì‹œì‘
- í˜„ì¬ëŠ” ë‹¨ì¼ ì‹œë¦¬ì¦ˆë§Œ ì§€ì› (í•­ìƒ 1)

### Option ID
- 0ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ë¶€ì—¬
- ê³„ì¸µ ì»¬ëŸ¼(íƒ€ì…~ì‚¬ì´ì¦ˆ) ë¨¼ì €, ë¦¬í”„ ì»¬ëŸ¼ ë‚˜ì¤‘

### EnumID (ê°’ ID)
- ê° ì˜µì…˜ ë‚´ì—ì„œ 0ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ë¶€ì—¬
- ê°™ì€ ê°’ì´ ì—¬ëŸ¬ ì˜µì…˜ì— ìˆì–´ë„ ê°ê° ë‹¤ë¥¸ ID

---

## ğŸ’» êµ¬í˜„ í´ë˜ìŠ¤

### Services/JsonExporter.cs

```csharp
public class JsonExporter
{
    // JSON êµ¬ì¡° í´ë˜ìŠ¤
    public class RootData { ... }
    public class SeriesItem { ... }
    public class OptionItem { ... }
    public class OptionValue { ... }

    // ë©”ì¸ ë©”ì„œë“œ
    public void Export(string filePath);
    public string ExportToString();

    // ë‚´ë¶€ ë¹Œë“œ ë©”ì„œë“œ
    private RootData BuildJsonStructure();
    private OptionItem BuildHierarchyOption(...);
    private OptionItem BuildLeafOption(...);
}
```

### MainWindow.xaml.cs

```csharp
private void ExportToJson_Click(object sender, RoutedEventArgs e)
{
    var exporter = new JsonExporter(_data);
    exporter.Export(filePath);
}
```

---

## ğŸ“¤ ì¶œë ¥ ì˜ˆì‹œ

### Excel ì…ë ¥
```
íƒ€ì…  | ê·œê²©           | ìš©ë„   | ì¬ì§ˆ
------|----------------|--------|------
KS    | KS B 1002:2016 | ê¸°ê³„ìš© | S10C
KS    | KS B 1002:2016 | ê¸°ê³„ìš© | SS400
KS    | KS B 1002:2016 | PCìš©   | PC
JIS   | JIS B 1180     | ì¼ë°˜   | SUS304
```

### JSON ì¶œë ¥
```json
{
  "Series": [{
    "name": "ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸",
    "id": 1,
    "option": [
      {
        "id": 0,
        "name": "íƒ€ì…",
        "values": [
          { "enumid": 0, "name": "KS", "filter": ["-1"], "filter_Values": [["-1"]] },
          { "enumid": 1, "name": "JIS", "filter": ["-1"], "filter_Values": [["-1"]] }
        ]
      },
      {
        "id": 1,
        "name": "ê·œê²©",
        "values": [
          { "enumid": 0, "name": "KS B 1002:2016", "filter": ["0"], "filter_Values": [["0"]] },
          { "enumid": 1, "name": "JIS B 1180", "filter": ["0"], "filter_Values": [["1"]] }
        ]
      },
      {
        "id": 2,
        "name": "ìš©ë„",
        "values": [
          { "enumid": 0, "name": "ê¸°ê³„ìš©", "filter": ["1"], "filter_Values": [["0"]] },
          { "enumid": 1, "name": "PCìš©", "filter": ["1"], "filter_Values": [["0"]] },
          { "enumid": 2, "name": "ì¼ë°˜", "filter": ["1"], "filter_Values": [["1"]] }
        ]
      },
      {
        "id": 3,
        "name": "ì¬ì§ˆ",
        "values": [
          { "enumid": 0, "name": "S10C", "filter": ["2"], "filter_Values": [["0"]] },
          { "enumid": 1, "name": "SS400", "filter": ["2"], "filter_Values": [["0"]] },
          { "enumid": 2, "name": "PC", "filter": ["2"], "filter_Values": [["1"]] },
          { "enumid": 3, "name": "SUS304", "filter": ["2"], "filter_Values": [["2"]] }
        ]
      }
    ]
  }]
}
```

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ë°ì´í„° ë¡œë“œ í•„ìš”
- Excel íŒŒì¼ì„ ë¨¼ì € ì—´ì–´ì•¼ JSON ë‚´ë³´ë‚´ê¸° ê°€ëŠ¥
- ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê²½ê³  ë©”ì‹œì§€ í‘œì‹œ

### 2. í•œê¸€ íŒŒì¼ëª…
- í•œê¸€ íŒŒì¼ëª… ì§€ì›
- íŠ¹ìˆ˜ë¬¸ìëŠ” ìë™ìœ¼ë¡œ `_`ë¡œ ë³€í™˜

### 3. ì¸ì½”ë”©
- UTF-8ë¡œ ì €ì¥ë¨
- ë©”ëª¨ì¥ì—ì„œ ì—´ë©´ í•œê¸€ ì •ìƒ í‘œì‹œ

### 4. ë‹¤ì¤‘ ê°’ ì²˜ë¦¬
- ì‰¼í‘œ(,) ë˜ëŠ” ê°œí–‰(\n)ìœ¼ë¡œ êµ¬ë¶„ëœ ê°’ì€ ê°œë³„ í•­ëª©ìœ¼ë¡œ ë¶„ë¦¬
- ì˜ˆ: "S10C\nSS400" â†’ enumid 0, 1ë¡œ ë¶„ë¦¬

---

## ğŸ”„ í•„í„°ë§ ë¡œì§ í™œìš©

### CAD ì¸¡ì—ì„œ JSON ì‚¬ìš© ë°©ë²•

```cpp
// 1. íƒ€ì… ì„ íƒ (KS, enumid=0)
// 2. ê·œê²© ëª©ë¡ í•„í„°ë§
for (auto& value : options[1].values) {
    // filter_Valuesì— íƒ€ì…ì˜ enumid(0)ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ í‘œì‹œ
    if (value.filter_Values[0].contains("0")) {
        // ì´ ê·œê²© í‘œì‹œ
    }
}

// 3. ê·œê²© ì„ íƒ í›„ ìš©ë„ í•„í„°ë§ë„ ë™ì¼í•˜ê²Œ...
```

---

## ğŸ“ íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ì„¤ëª… |
|------|------|
| `Services/JsonExporter.cs` | JSON ë³€í™˜ í´ë˜ìŠ¤ |
| `MainWindow.xaml` | ë©”ë‰´ ì¶”ê°€ |
| `MainWindow.xaml.cs` | í•¸ë“¤ëŸ¬ ì¶”ê°€ |
| `ìœ¡ê°ë¨¸ë¦¬ë³¼íŠ¸_Data_Sample.json` | ìƒ˜í”Œ ì¶œë ¥ |

---

**ì¶”ê°€ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ ë§ì”€í•´ì£¼ì„¸ìš”!**
