<Window x:Class="ExcelToPostgres.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ExcelToPostgres"
        mc:Ignorable="d"
        Title="Excel â†’ PostgreSQL ë°ì´í„° ê´€ë¦¬" 
        Height="750" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Background="#ECEFF1">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- í—¤ë” -->
        <Border Grid.Row="0" Background="#37474F" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="ðŸ“Š" FontSize="24" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBlock Text="Excel â†’ PostgreSQL ë°ì´í„° ê´€ë¦¬" 
                               FontSize="20" FontWeight="Bold" Foreground="White" 
                               VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="DB ìƒíƒœ:" Foreground="#B0BEC5" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <Ellipse x:Name="ConnectionIndicator" Width="12" Height="12" Fill="#F44336" VerticalAlignment="Center"/>
                    <TextBlock x:Name="ConnectionStatusText" Text="ì—°ê²° ì•ˆë¨" Foreground="#B0BEC5" 
                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ë„êµ¬ ëª¨ìŒ -->
        <Border Grid.Row="1" Background="White" Padding="15,10" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- íŒŒì¼ ê´€ë ¨ ë²„íŠ¼ -->
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="BtnOpenExcel" Content="ðŸ“ Excel íŒŒì¼ ì—´ê¸°" Click="BtnOpenExcel_Click"/>
                    <TextBlock x:Name="TxtFileName" Text="íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”" 
                               VerticalAlignment="Center" Foreground="#757575" Margin="10,0,0,0"/>
                </StackPanel>

                <!-- DB ê´€ë ¨ ë²„íŠ¼ -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button x:Name="BtnDbSettings" Content="âš™ï¸ DB ì„¤ì •" Click="BtnDbSettings_Click"/>
                    <Button x:Name="BtnTestConnection" Content="ðŸ”Œ ì—°ê²° í…ŒìŠ¤íŠ¸" Click="BtnTestConnection_Click"/>
                    <Button x:Name="BtnCreateTables" Content="ðŸ—ƒï¸ í…Œì´ë¸” ìƒì„±" Click="BtnCreateTables_Click"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ë©”ì¸ ì½˜í…ì¸  (íƒ­) -->
        <TabControl x:Name="MainTabControl" Grid.Row="2" Margin="15">
            <!-- MainCategory íƒ­ -->
            <TabItem Header="MainCategory (ëŒ€ë¶„ë¥˜)">
                <DataGrid x:Name="GridMainCategory" Margin="5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ì½”ë“œ" Binding="{Binding MainCatCode}" Width="120"/>
                        <DataGridTextColumn Header="ì´ë¦„(EN)" Binding="{Binding MainCatName}" Width="150"/>
                        <DataGridTextColumn Header="ì´ë¦„(KR)" Binding="{Binding MainCatNameKr}" Width="120"/>
                        <DataGridCheckBoxColumn Header="í‘œì¤€" Binding="{Binding IsStandard}" Width="60"/>
                        <DataGridTextColumn Header="ìƒ‰ìƒì½”ë“œ" Binding="{Binding ColorCode}" Width="100"/>
                        <DataGridTextColumn Header="ì •ë ¬ìˆœì„œ" Binding="{Binding SortOrder}" Width="80"/>
                        <DataGridCheckBoxColumn Header="í™œì„±" Binding="{Binding IsActive}" Width="60"/>
                        <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- SubCategory íƒ­ -->
            <TabItem Header="SubCategory (ì¤‘ë¶„ë¥˜)">
                <DataGrid x:Name="GridSubCategory" Margin="5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ì½”ë“œ" Binding="{Binding SubCatCode}" Width="120"/>
                        <DataGridTextColumn Header="ì´ë¦„(EN)" Binding="{Binding SubCatName}" Width="120"/>
                        <DataGridTextColumn Header="ì´ë¦„(KR)" Binding="{Binding SubCatNameKr}" Width="100"/>
                        <DataGridTextColumn Header="ìƒìœ„ë¶„ë¥˜" Binding="{Binding MainCatCode}" Width="100"/>
                        <DataGridCheckBoxColumn Header="ë²¤ë”" Binding="{Binding IsVendor}" Width="60"/>
                        <DataGridTextColumn Header="ë²¤ë”ì½”ë“œ" Binding="{Binding VendorCode}" Width="80"/>
                        <DataGridTextColumn Header="êµ­ê°€" Binding="{Binding Country}" Width="80"/>
                        <DataGridTextColumn Header="ì •ë ¬" Binding="{Binding SortOrder}" Width="60"/>
                        <DataGridCheckBoxColumn Header="í™œì„±" Binding="{Binding IsActive}" Width="60"/>
                        <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- MidCategory íƒ­ -->
            <TabItem Header="MidCategory (ì†Œë¶„ë¥˜)">
                <DataGrid x:Name="GridMidCategory" Margin="5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ì½”ë“œ" Binding="{Binding MidCatCode}" Width="120"/>
                        <DataGridTextColumn Header="ì´ë¦„(EN)" Binding="{Binding MidCatName}" Width="150"/>
                        <DataGridTextColumn Header="ì´ë¦„(KR)" Binding="{Binding MidCatNameKr}" Width="120"/>
                        <DataGridTextColumn Header="ìƒìœ„ë¶„ë¥˜" Binding="{Binding SubCatCode}" Width="120"/>
                        <DataGridTextColumn Header="ì •ë ¬ìˆœì„œ" Binding="{Binding SortOrder}" Width="80"/>
                        <DataGridCheckBoxColumn Header="í™œì„±" Binding="{Binding IsActive}" Width="60"/>
                        <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- PartType íƒ­ -->
            <TabItem Header="PartType (ë¶€í’ˆíƒ€ìž…)">
                <DataGrid x:Name="GridPartType" Margin="5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ì½”ë“œ" Binding="{Binding PartTypeCode}" Width="120"/>
                        <DataGridTextColumn Header="ì´ë¦„(EN)" Binding="{Binding PartTypeName}" Width="180"/>
                        <DataGridTextColumn Header="ì´ë¦„(KR)" Binding="{Binding PartTypeNameKr}" Width="120"/>
                        <DataGridTextColumn Header="Subë¶„ë¥˜" Binding="{Binding SubCatCode}" Width="100"/>
                        <DataGridTextColumn Header="Midë¶„ë¥˜" Binding="{Binding MidCatCode}" Width="100"/>
                        <DataGridTextColumn Header="ë²¤ë”" Binding="{Binding VendorCode}" Width="80"/>
                        <DataGridCheckBoxColumn Header="ì‹œë¦¬ì¦ˆ" Binding="{Binding HasSeries}" Width="60"/>
                        <DataGridTextColumn Header="ì •ë ¬" Binding="{Binding SortOrder}" Width="60"/>
                        <DataGridCheckBoxColumn Header="í™œì„±" Binding="{Binding IsActive}" Width="60"/>
                        <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- PartSeries íƒ­ -->
            <TabItem Header="PartSeries (ì‹œë¦¬ì¦ˆ)">
                <DataGrid x:Name="GridPartSeries" Margin="5">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ì½”ë“œ" Binding="{Binding SeriesCode}" Width="120"/>
                        <DataGridTextColumn Header="ì´ë¦„(EN)" Binding="{Binding SeriesName}" Width="120"/>
                        <DataGridTextColumn Header="ì´ë¦„(KR)" Binding="{Binding SeriesNameKr}" Width="100"/>
                        <DataGridTextColumn Header="ë¶€í’ˆíƒ€ìž…" Binding="{Binding PartTypeCode}" Width="120"/>
                        <DataGridTextColumn Header="ë²¤ë”" Binding="{Binding VendorCode}" Width="80"/>
                        <DataGridTextColumn Header="ëª¨ë¸ì ‘ë‘ì‚¬" Binding="{Binding ModelPrefix}" Width="100"/>
                        <DataGridTextColumn Header="ì •ë ¬" Binding="{Binding SortOrder}" Width="60"/>
                        <DataGridCheckBoxColumn Header="í™œì„±" Binding="{Binding IsActive}" Width="60"/>
                        <DataGridTextColumn Header="ì„¤ëª…" Binding="{Binding Description}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>

        <!-- í•˜ë‹¨ ìƒíƒœë°” ë° ì €ìž¥ ë²„íŠ¼ -->
        <Border Grid.Row="3" Background="White" Padding="15,10" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="TxtStatus" Text="ì¤€ë¹„ë¨" Foreground="#757575" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TxtRowCount" Text="" Foreground="#9E9E9E" VerticalAlignment="Center" Margin="20,0,0,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="BtnReload" Content="ðŸ”„ ë‹¤ì‹œ ë¡œë“œ" Click="BtnReload_Click" IsEnabled="False"/>
                    <Button x:Name="BtnSaveToDb" Content="ðŸ’¾ DBì— ì €ìž¥" Click="BtnSaveToDb_Click" 
                            Style="{StaticResource SaveButton}" IsEnabled="False"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
