<Window x:Class="DimensionManager.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ì¹˜ìˆ˜ ë°ì´í„° ê´€ë¦¬ìž" 
        Height="700" Width="1200"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- íˆ´ë°” -->
        <ToolBar Grid.Row="0" Margin="5">
            <Button x:Name="BtnLoadExcel" Content="ðŸ“‚ ì—‘ì…€ íŒŒì¼ ì—´ê¸°" Click="BtnLoadExcel_Click"/>
            <Separator/>
            <Button x:Name="BtnDbSettings" Content="âš™ DB ì„¤ì •" Click="BtnDbSettings_Click"/>
            <Button x:Name="BtnTestConnection" Content="ðŸ”Œ ì—°ê²° í…ŒìŠ¤íŠ¸" Click="BtnTestConnection_Click"/>
            <Button x:Name="BtnCreateTables" Content="ðŸ“‹ í…Œì´ë¸” ìƒì„±" Click="BtnCreateTables_Click"/>
            <Separator/>
            <Button x:Name="BtnSaveToDb" Content="ðŸ’¾ DBì— ì €ìž¥" Click="BtnSaveToDb_Click" 
                    Background="#4CAF50" Foreground="White" FontWeight="Bold"/>
        </ToolBar>

        <!-- íŒŒì¼ ì •ë³´ ë° ìš”ì•½ -->
        <GroupBox Grid.Row="1" Header="Import ì •ë³´" Margin="10,5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0" Text="íŒŒì¼:" Margin="5" FontWeight="Bold"/>
                <TextBlock Grid.Row="0" Grid.Column="1" x:Name="TxtFileName" Text="-" Margin="5" 
                           TextTrimming="CharacterEllipsis"/>

                <TextBlock Grid.Row="0" Grid.Column="2" Text="Part Code:" Margin="5" FontWeight="Bold"/>
                <TextBlock Grid.Row="0" Grid.Column="3" x:Name="TxtPartCode" Text="-" Margin="5"
                           Foreground="Blue" FontWeight="Bold"/>

                <TextBlock Grid.Row="0" Grid.Column="4" Text="Standard:" Margin="5" FontWeight="Bold"/>
                <TextBlock Grid.Row="0" Grid.Column="5" x:Name="TxtStandard" Text="-" Margin="5"/>

                <TextBlock Grid.Row="1" Grid.Column="0" Text="í‚¤ í•„ë“œ:" Margin="5" FontWeight="Bold"/>
                <TextBlock Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3" x:Name="TxtKeyFields" Text="-" Margin="5"
                           Foreground="DarkOrange"/>

                <TextBlock Grid.Row="1" Grid.Column="4" Text="ë°ì´í„° í–‰:" Margin="5" FontWeight="Bold"/>
                <TextBlock Grid.Row="1" Grid.Column="5" x:Name="TxtRowCount" Text="-" Margin="5"/>
            </Grid>
        </GroupBox>

        <!-- íƒ­ ì»¨íŠ¸ë¡¤ -->
        <TabControl Grid.Row="2" Margin="10,5" x:Name="MainTabControl">
            <!-- ì›ë³¸ ë°ì´í„° íƒ­ -->
            <TabItem Header="ðŸ“Š ì›ë³¸ ë°ì´í„°">
                <DataGrid x:Name="DataGridRaw" 
                          AutoGenerateColumns="True"
                          CanUserAddRows="False"
                          IsReadOnly="True"/>
            </TabItem>

            <!-- ì»¬ëŸ¼ ì •ë³´ íƒ­ -->
            <TabItem Header="ðŸ“‹ ì»¬ëŸ¼ ì •ë³´ (Meta)">
                <DataGrid x:Name="DataGridMeta" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ìˆœì„œ" Binding="{Binding DisplayOrder}" Width="50"/>
                        <DataGridTextColumn Header="í•„ë“œëª…" Binding="{Binding FieldName}" Width="100"/>
                        <DataGridTextColumn Header="í‘œì‹œëª…" Binding="{Binding DisplayName}" Width="120"/>
                        <DataGridTextColumn Header="ì˜ë¬¸ëª…" Binding="{Binding DisplayNameEn}" Width="100"/>
                        <DataGridTextColumn Header="ë°ì´í„°íƒ€ìž…" Binding="{Binding DataType}" Width="80"/>
                        <DataGridCheckBoxColumn Header="í‚¤í•„ë“œ" Binding="{Binding IsKeyField}" Width="60"/>
                        <DataGridCheckBoxColumn Header="í‘œì‹œ" Binding="{Binding IsDisplayField}" Width="50"/>
                        <DataGridTextColumn Header="ì»¬ëŸ¼í­" Binding="{Binding ColumnWidth}" Width="60"/>
                        <DataGridTextColumn Header="CADíŒŒë¼ë¯¸í„°" Binding="{Binding CadParamName}" Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- í‚¤ ì˜µì…˜ íƒ­ -->
            <TabItem Header="ðŸ”‘ í‚¤ ì˜µì…˜">
                <DataGrid x:Name="DataGridKeyOptions" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Part Code" Binding="{Binding PartCode}" Width="100"/>
                        <DataGridTextColumn Header="í‚¤ í•„ë“œ" Binding="{Binding KeyFieldName}" Width="100"/>
                        <DataGridTextColumn Header="ë ˆë²¨" Binding="{Binding KeyLevel}" Width="50"/>
                        <DataGridTextColumn Header="í‚¤ ê°’" Binding="{Binding KeyValue}" Width="150"/>
                        <DataGridTextColumn Header="ìƒìœ„ í‚¤" Binding="{Binding ParentKey}" Width="100"/>
                        <DataGridTextColumn Header="ì •ë ¬ìˆœì„œ" Binding="{Binding SortOrder}" Width="70"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>

            <!-- ì¹˜ìˆ˜ ë°ì´í„° íƒ­ -->
            <TabItem Header="ðŸ“ ì¹˜ìˆ˜ ë°ì´í„° (JSON)">
                <DataGrid x:Name="DataGridDimensions" AutoGenerateColumns="False">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Part Code" Binding="{Binding PartCode}" Width="80"/>
                        <DataGridTextColumn Header="Key Composite" Binding="{Binding KeyComposite}" Width="200"/>
                        <DataGridTextColumn Header="Key Values (JSON)" Binding="{Binding KeyValuesJson}" Width="250"/>
                        <DataGridTextColumn Header="Dimension Data (JSON)" Binding="{Binding DimensionDataJson}" Width="*"/>
                    </DataGrid.Columns>
                </DataGrid>
            </TabItem>
        </TabControl>

        <!-- DB ì—°ê²° ìƒíƒœ -->
        <GroupBox Grid.Row="3" Header="DB ì—°ê²°" Margin="10,5">
            <StackPanel Orientation="Horizontal">
                <Ellipse x:Name="ConnectionIndicator" Width="12" Height="12" Fill="Gray" Margin="5"/>
                <TextBlock x:Name="ConnectionStatusText" Text="ì—°ê²° ì•ˆë¨" VerticalAlignment="Center" Margin="5,0"/>
                <TextBlock Text=" | " VerticalAlignment="Center"/>
                <TextBlock x:Name="TxtDbInfo" Text="Host: localhost | DB: Standard_Core" 
                           VerticalAlignment="Center" Foreground="Gray"/>
            </StackPanel>
        </GroupBox>

        <!-- ìƒíƒœ ë°” -->
        <StatusBar Grid.Row="4">
            <StatusBarItem>
                <TextBlock x:Name="TxtStatus" Text="ì¤€ë¹„"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
